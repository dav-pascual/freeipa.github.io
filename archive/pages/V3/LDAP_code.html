<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Logging_and_output.html" />
    <link rel="prev" title="Overview" href="Kerberos_Flags.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>__NOTOC__</p>
<section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>Ticket <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/2660">#2660</a>
installer code should use ldap2</p>
<p>This is important to do. We really should have just one API and set of
classes for dealing with LDAP. For the DN work we had to refactor a fair
amount of code in order to force most things to funnel through one
common code location. Because ldap is so decentralized and we had so
many different APIs, classes, etc it was a large chunk of work and is
only partially completed, it got a lot better but it wasn’t finished.</p>
<p>The primary thing which needs to be resolved is our use of Entity and
Entry classes. There never should have been two almost identical
classes. One or both of Entity/Entry needs to be removed.</p>
<p>As it stands now we have two basic ways we access ldap results. In the
installer code it’s mostly via Entity/Entry objects. But in the server
code (ldpa2) it’s done by accessing the data as returned by the python
ldap module (e.g. list of (DN, attr_dict) tuples).</p>
<p>We need to decide which of the two basic interfaces we’re going to use
and converge on it. Each approach has merits. But 3 different API’s for
interacting with ldap is 2 too many.</p>
</section>
<section id="use-cases">
<span id="use-cases10d"></span><h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h1>
<section id="entry-representation">
<span id="id1"></span><h2>Entry representation<a class="headerlink" href="#entry-representation" title="Permalink to this heading">¶</a></h2>
<p>LDAP entries will be encapsulated in objects. These will perform type
checking and validation (ticket #2357). They should grow from
ldap2.LDAPEntry (which is currently just a “dn, data” namedtuple).</p>
<p>These objects will behave like a dict of lists:</p>
<div class="line-block">
<div class="line">`` entry[attrname] = [value]``</div>
<div class="line">`` attrname in entry``</div>
<div class="line">`` del entry[attrname]``</div>
<div class="line">:literal:` entry.keys(), .values(), .items()  # but NOT <cite>for key in entry</cite>, see below`</div>
</div>
<p>The keys are case-insensitive but case-preserving.</p>
<p>We’ll use lists for all attributes, even single-valued ones, because
“single-valuedness” can change.</p>
<p>The object should also “rembember” its original set of attributes, so we
don’t have to retrieve them from LDAP again when it’s updated.</p>
</section>
<section id="the-connection-backend-class">
<span id="the-connectionbackend-class"></span><h2>The connection/backend class<a class="headerlink" href="#the-connection-backend-class" title="Permalink to this heading">¶</a></h2>
<p>We’ll continue to use the ldap2 plugin for “normal” connections, and the
IPAdmin class for connections that need special authentication or happen
before the server is configured (or after is unconfigured). Most of the
code and API will be common, and inherited from a new
ipapython.ipaldap.LDAPConnection class. The common API will match the
current ldap2 API. The common code will move to ipapython, so that it is
also available to the client installer.</p>
<p>ldap2 has some overly specific “helper” methods like
remove_principal_key or modify_password. We shouldn’t add new ones, and
the existing ones should be moved away eventually.</p>
</section>
<section id="backwards-compatibility-porting">
<span id="id2"></span><h2>Backwards compatibility, porting<a class="headerlink" href="#backwards-compatibility-porting" title="Permalink to this heading">¶</a></h2>
<p>For compatibility with existing plugins, the LDAPEntry object will
unpack to a tuple:</p>
<p>`` dn, entry_attrs = entry``</p>
<p>(the entry_attrs can be entry itself, so we keep the object’s validation
powers.)</p>
<p>The legacy Entry interface (toTupleList, toDict, setValues, data,
origDataDict, …) will be temporarily added to LDAPEntry. Code will be
moved away from using it.</p>
<p>The backwards compatibility stuff should be removed as soon as it’s
unused.</p>
<p>Of course code using the raw python-ldap API will also be converted to
ldap2.</p>
</section>
</section>
<section id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">¶</a></h1>
<p>No additional requirements or changes discovered during the
implementation phase.</p>
</section>
<section id="feature-managment">
<span id="id3"></span><h1>Feature Managment<a class="headerlink" href="#feature-managment" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="major-configuration-options-and-enablement">
<h1>Major configuration options and enablement<a class="headerlink" href="#major-configuration-options-and-enablement" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="replication">
<h1>Replication<a class="headerlink" href="#replication" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="updates-and-upgrades">
<h1>Updates and Upgrades<a class="headerlink" href="#updates-and-upgrades" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="dependencies">
<h1>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="external-impact">
<h1>External Impact<a class="headerlink" href="#external-impact" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="design-page-authors">
<span id="id4"></span><h1>Design page authors<a class="headerlink" href="#design-page-authors" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="User:Pviktorin">Pviktorin</a>, jdennis</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V3/LDAP_code.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>