<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Drop_CSV.html" />
    <link rel="prev" title="Overview" href="DNS_SOA_serial_auto-incrementation.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>__NOTOC__</p>
<section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>Related ticket: <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/3544">#3544</a></p>
<p>When AD trust is established, upon validation AD DC is capable to fetch
information about trusted forest configuration, including additional
name suffixes to use when creating routing to trusted domain. This gives
an opportunity to make multiple DNS domain configurations supported in
AD trust.</p>
<p>When AD DC knows about these additional DNS domains, it is capable to
properly ask our KDCs for tickets for services in those domains and
trust them via our trust.</p>
<p>This is how it looks from Windows side:</p>
<figure class="align-default" id="id1">
<img alt="Win2012-multiple-suffixes.png" src="../../../_images/Win2012-multiple-suffixes.png" />
<figcaption>
<p><span class="caption-text">Win2012-multiple-suffixes.png</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>For the domains that Windows manages as a DNS server, it exposes the
same list via the same SMB interface.</p>
<p>Realmdomains information will also be used by SSSD to fetch and
configure mapping between DNS domains and realms within IPA.</p>
<p>So from our side it means we need to hook into <code class="docutils literal notranslate"><span class="pre">'ipa</span> <span class="pre">dnszone-add'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'ipa</span> <span class="pre">dnszone-del'</span></code> to call <code class="docutils literal notranslate"><span class="pre">'ipa</span> <span class="pre">realmdomains-mod'</span></code> for
non-forwarded zones. Any error when removing the domain with
<code class="docutils literal notranslate"><span class="pre">'ipa</span> <span class="pre">realmdomains-mod</span> <span class="pre">--del-domain'</span></code> should be ignored because the
domain in question might not be in the list of realm’s domains by
admin’s intention.</p>
<p>Also, a <code class="docutils literal notranslate"><span class="pre">_kerberos</span> <span class="pre">TXT</span></code> record containing the realm name should be
added to the DNS zone as a part of this process.</p>
</section>
<section id="use-cases">
<span id="use-cases2"></span><h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>Admin creates a new DNS zone in IPA using the <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">dnszone-add</span></code>
command. As a result, a new entry is added to realmdomains and
<code class="docutils literal notranslate"><span class="pre">_kerberos</span> <span class="pre">TXT</span></code> record is added to the DNS zone.</p></li>
<li><p>Admin creates a new forwarded zone in IPA. No other side effects
happen since the zone is not managed by IPA.</p></li>
<li><p>Admin adds a new domain <code class="docutils literal notranslate"><span class="pre">new-domain.com</span></code> to the realmdomains
object, using <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">realmdomains-mod</span> <span class="pre">--add-domain=new-domain.com</span></code> or
<code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">realmdomains-mod</span> <span class="pre">--domain={ipa-domain.org,new-domain.com}</span></code>. If
IPA manages the DNS zone for <code class="docutils literal notranslate"><span class="pre">new-domain.com</span></code>, <code class="docutils literal notranslate"><span class="pre">_kerberos</span> <span class="pre">TXT</span></code>
record is added to the zone.</p></li>
<li><p>Admin deletes a domain <code class="docutils literal notranslate"><span class="pre">new-domain.com</span></code> from the realmdomains
object, using <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">realmdomains-mod</span> <span class="pre">--del-domain=new-domain.com</span></code> or
<code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">realmdomains-mod</span> <span class="pre">--domain={ipa-domain.org}</span></code>. If IPA manages
the DNS zone for <code class="docutils literal notranslate"><span class="pre">new-domain.com</span></code> and <code class="docutils literal notranslate"><span class="pre">_kerberos</span> <span class="pre">TXT</span></code> record
exists in this zone and contains the name of the realm, the record is
deleted.</p></li>
<li><p>Admin deletes a DNS zone using the <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">dnszone-del</span></code> command. If a
domain with the same name as the zone exists in the realmdomains
object, it is deleted.</p></li>
</ul>
</section>
<section id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h1>
<p>Add functionality to the <code class="docutils literal notranslate"><span class="pre">post_callback()</span></code> methods of <code class="docutils literal notranslate"><span class="pre">dnszone_add</span></code>
and <code class="docutils literal notranslate"><span class="pre">dnszone_del</span></code>. These methods should now include the calls to
<code class="docutils literal notranslate"><span class="pre">realmdomains-mod</span> <span class="pre">--add-domain</span></code> and <code class="docutils literal notranslate"><span class="pre">realmdomains-mod</span> <span class="pre">--del-domain</span></code>,
respectively, in order to implement the addition/deletion of entries to
the realmdomain object upon DNS zone creation. The call to
<code class="docutils literal notranslate"><span class="pre">realmdomains-mod</span></code> will not be executed in the following cases:</p>
<ul class="simple">
<li><p>for our own domain</p></li>
<li><p>for forwarded zones</p></li>
<li><p>for reverse zones</p></li>
</ul>
<p>Implement the <code class="docutils literal notranslate"><span class="pre">execute()</span></code> method of <code class="docutils literal notranslate"><span class="pre">realmdomains_mod</span></code>. This method
should include the calls to <code class="docutils literal notranslate"><span class="pre">dnsrecord_add</span></code> and <code class="docutils literal notranslate"><span class="pre">dnsrecord_del</span></code>, in
order to implement the addition/deletion of the <code class="docutils literal notranslate"><span class="pre">_kerberos</span> <span class="pre">TXT</span></code> record
upon modification of the realmdomains object. The call to
<code class="docutils literal notranslate"><span class="pre">dnsrecord_del</span></code> will not be executed in the case of our own domain.</p>
<p>Add a normalizer to all the options of <code class="docutils literal notranslate"><span class="pre">realmdomains_mod</span></code>. The
normalizer should lowercase the arguments and strip the trailing dot.</p>
<p>Add new unit tests to cover these newly added functionalities.</p>
</section>
<section id="feature-management">
<span id="feature-management2"></span><h1>Feature Management<a class="headerlink" href="#feature-management" title="Permalink to this heading">¶</a></h1>
<section id="ui">
<h2>UI<a class="headerlink" href="#ui" title="Permalink to this heading">¶</a></h2>
<p>N/A</p>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Permalink to this heading">¶</a></h2>
<p>N/A</p>
</section>
</section>
<section id="major-configuration-options-and-enablement">
<span id="major-configuration-options-and-enablement2"></span><h1>Major configuration options and enablement<a class="headerlink" href="#major-configuration-options-and-enablement" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="replication">
<h1>Replication<a class="headerlink" href="#replication" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="updates-and-upgrades">
<span id="updates-and-upgrades2"></span><h1>Updates and Upgrades<a class="headerlink" href="#updates-and-upgrades" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="dependencies">
<h1>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="external-impact">
<span id="external-impact2"></span><h1>External Impact<a class="headerlink" href="#external-impact" title="Permalink to this heading">¶</a></h1>
<p>N/A</p>
</section>
<section id="rfe-author">
<span id="rfe-author2"></span><h1>RFE Author<a class="headerlink" href="#rfe-author" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="User:Akrivoka">akrivoka</a> 06:13, 12 April 2013 (EDT)</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V3/DNS_realmdomains_integration.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>