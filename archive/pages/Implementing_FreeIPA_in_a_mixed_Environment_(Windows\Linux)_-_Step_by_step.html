<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="Improve.html" />
    <link rel="prev" title="Testing trust between FreeIPA and AD" href="IPAv3_testing_AD_trust.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><strong>NOTE</strong>:the information provided on this page was only tested against
FreeIPA 1.2 and should be considered deprecated for anything newer.</p>
<p><strong>Introduction</strong></p>
<hr class="docutils" />
<p>The following documentation is a practical guide to implement freeIPA in
mixed environment (Windows/Linux Clients). You should also refer the
Administrator’s as well as Installation and Deployment guide from the
main documentation page.</p>
<p>The Installation has been performed on the following environment.</p>
<p>Server: Single IPA server (Fedora 10 x86_64) with 2G RAM 1.6 GHz Intel
Dual Core processor.</p>
<p>Clients: Windows XP SP2, Fedora 10 x86_64 and RHEL5.2 x86_64</p>
<p>Note: Please be careful about the firewall and selinux policies before
continuing with the configuration. In windows also you should open the
necessary ports to communicate to the IPA Server or disable the firewall
if you are doing a test setup. Please refer the installation and
deployment guide to get more details about the ports required for IPA.</p>
<ol class="arabic simple">
<li><p>Installation of the IPA Server.</p></li>
</ol>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># yum install ipa-*</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># yum install bind bind-chroot</span></code></div>
</div>
<p>The IPA server may show a conflict with mod_ssl package. IPA uses
mod_nss in apache. You can remove the mod_ssl for the time being.</p>
<p>2.Make sure that the host names are set properly</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># cat /etc/hosts</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">127.0.0.1               localhost.localdomain localhost</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">172.16.33.1             ds.example.com ds</span></code></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># cat /etc/sysconfig/network</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">NETWORKING=yes</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">HOSTNAME=ds.example.com</span></code></div>
</div>
<p>3. Run the following command to configure the IPA Server for you
environment and follow the instructions.</p>
<p><code class="docutils literal notranslate"><span class="pre"># ipa-server-install --setup-bind</span></code></p>
<p>Here the DNS Server is on the same machine. Please note that kerberos
server has very specific DNS requirements, if you have a DNS server
already on your network add the SRV records of the kerberos, ntp and
ldap server to that. A sample zone file will be created in your /tmp
directory after the ipa-server-install, do a copy paste of all the SRV
record from this file to your zone file.</p>
<p>If you have a chrooted bind installed, the named service start-up may
fail after the ipa-server-install . Do the following configuration to
setup DNS properly.</p>
<ol class="loweralpha simple">
<li><p>A minimal named.conf should look like</p></li>
</ol>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># cat /etc/named.conf</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">options {</span></code></div>
<div class="line">``       directory “/var/named”;``</div>
<div class="line">``       dump-file               “data/cache_dump.db”;``</div>
<div class="line">``       statistics-file         “data/named_stats.txt”;``</div>
<div class="line">``       memstatistics-file      “data/named_mem_stats.txt”;``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">};</span></code></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">zone &quot;example.com&quot; {</span></code></div>
<div class="line">``       type master;``</div>
<div class="line">``       file “example.com.zone.db”;``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">};</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">zone &quot;33.16.172.in-addr.arpa&quot; IN {</span></code></div>
<div class="line">``       type master;``</div>
<div class="line">``       file “example.com.zone.rev.db”;``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">};</span></code></div>
</div>
<p>b. Copy the zone file to the proper location and create a reverse zone
file also.</p>
<p><code class="docutils literal notranslate"><span class="pre"># cp /var/named/example.com.zone.db /var/named/chroot/var/named/</span></code></p>
<p>No need to change anything in the forward zone file, create a reverse
zone as follows.</p>
<p><code class="docutils literal notranslate"><span class="pre">#  cat example.com.zone.rev.db</span></code></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ORIGIN 33.16.172.in-addr.arpa.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$TTL    86400</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">&#64;                       IN SOA  example.com. root.example.com. (</span></code></div>
<div class="line">``                               01              ; serial``</div>
<div class="line">``                               3H              ; refresh``</div>
<div class="line">``                               15M             ; retry``</div>
<div class="line">``                               1W              ; expiry``</div>
<div class="line">``                               1D )            ; minimum``</div>
</div>
<div class="line-block">
<div class="line">``                        IN NS                   ds.example.com.``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">1                       IN PTR                  ds.example.com.</span></code></div>
</div>
<ol class="loweralpha simple" start="3">
<li><p>Restart the named service</p></li>
</ol>
<p>4. Check whether the ntp time synchronization is proper, if you don’t
want to sync to an external time server, configure a local time server
and synch all the clients to that.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># ntpstat</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># ntpq -p</span></code></div>
</div>
<p>Sample configuration file for an ntp local server.</p>
<p><code class="docutils literal notranslate"><span class="pre"># cat /etc/ntp.conf</span></code></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">restrict default nomodify notrap noquery</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">restrict 127.0.0.1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">broadcast 224.0.1.1 ttl 4</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">broadcastdelay 0.004</span></code></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">server  127.127.1.0</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">fudge   127.127.1.0 stratum 10</span></code></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">driftfile /var/lib/ntp/drift</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">keys /etc/ntp/keys</span></code></div>
</div>
<p>Sample Configuration for an ntp client</p>
<p><code class="docutils literal notranslate"><span class="pre"># cat /etc/ntp.conf</span></code></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">restrict default kod nomodify notrap nopeer noquery</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">restrict -6 default kod nomodify notrap nopeer noquery</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">restrict 127.0.0.1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">restrict -6 ::1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">server  ds.example.com</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">driftfile /var/lib/ntp/drift</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">keys /etc/ntp/keys</span></code></div>
</div>
<p>Please note that if the client time has much difference compared to ntp
server then do a force update using the following command. Also, the
first time synchronization will take some time (64 sec approx)</p>
<p><code class="docutils literal notranslate"><span class="pre"># ntpdate -u ds.example.com</span></code></p>
<p>To verify</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># ntpstat</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># ntpq -p</span></code></div>
</div>
<p>5. Make sure that all the required services are enabled in your run
level and reboot the IPA server (krb5kdc, ntp, named, httpd, dirserv
etc). This will be configured automatically when you run the
ipa-server-install, anyway just do a second check.</p>
<p>6. After the reboot test the IPA server configuration using the
following commands</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># kinit admin</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># klist</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># ipa-finduser admin</span></code></div>
</div>
<p><strong>Configuring Windows Client</strong></p>
<hr class="docutils" />
<p>Note: An alternative solution exists: <a class="reference external" href="Windows_authentication_against_FreeIPA">Windows authentication against
FreeIPA</a></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">1. Add the host records in DNS, both forward and reverse</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">2. Make sure that the client is synchronized to the ntp server.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">3. On the IPA Server add the host principal and set the password for the xp client.</span></code></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">#  ipa-addservice host/bmdata01.example.com</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">#  ipa-getkeytab -s ds.example.com  -p host/bmdata01.example.com -e des-cbc-crc -k krb5.keytab.txt -P</span></code></div>
</div>
<ol class="arabic simple" start="4">
<li><p>On the Client (Windows XP)</p></li>
</ol>
<p>a. Install Windows XP support tools
(WindowsXP-KB838079-SupportTools-ENU.exe, this can be found on the
Windows XP Media or download it from microsoft)</p>
<p>b. Create a user in Windows XP to map the kerberos principles (here it
is ipauser)</p>
<p>c. Configure kerberos authentication as follows (go to Start - Programs
- Windows Support Tools - Command Prompt )</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">C:&gt; ksetup /setrealm EXAMPLE.COM</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">C:&gt; ksetup /addkdc EXAMPLE.COM dc.example.com</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">C:&gt; ksetup /setmachpassword ``\</span> <span class="pre">`` (the same password you have set in IPA server)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">C:&gt; ksetup /mapuser * ipauser</span></code></div>
</div>
<ol class="loweralpha simple" start="4">
<li><p>Reboot the machine.</p></li>
</ol>
<p>e. You will see “EXAMPLE.COM (Kerberos Realm)” in the windows logon drop
down menu.</p>
<p>Note: <strong>CREATE A NEW USER ON THE IPA SERVER AND TRY TO LOGON TO THE
WINDOWS CLIENT. WINDOWS WILL TELL YOU THAT THE PASSWORD HAS BEEN
EXPIRED. IT WILL PROMPT YOU TO SET THE NEW PASSWORD ALSO. IF YOU ENTER
YOUR USER NAME, OLD PASSWORD AND NEW PASSWORDS, WINDOWS WILL SIMPLY TELL
YOU “DOMAIN NOT AVAILABLE</strong></p>
<p><strong>HERE IS THE TRICK, PLEASE NOTE THAT THE USER IS REQUIRED TO LOGIN
USING “USER&#64;REALM” (testuser&#64;EXAMPLE.COM) INSTEAD OF JUST THE USER NAME
FOR THE FIRST TIME.</strong></p>
<p><strong>Configuring RHEL 5.2 x86_64 Client</strong></p>
<hr class="docutils" />
<p>1. Download and un-compress freeipa source,
<a class="reference external" href="http://freeipa.org/downloads/src/freeipa-1.2.1.tar.gz">http://freeipa.org/downloads/src/freeipa-1.2.1.tar.gz</a></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># tar -zxvf freeipa-1.2.1.tar.gz</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># cd freeipa-1.2.1</span></code></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Install the following prerequisites</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre"># yum install autoconf automake pkgconfig.x86_64 libtool.x86_64 mozldap-devel.x86_64 krb5-devel.x86_64 openldap-devel.x86_64 python-ldap.x86_64</span></code></p>
<p>3. You will also need to downloaded and install python-krbV package from
<a class="reference external" href="http://download.fedora.redhat.com/pub/epel/">http://download.fedora.redhat.com/pub/epel/</a></p>
<ol class="arabic simple" start="4">
<li><p>Apply the patch</p></li>
</ol>
<p># patch -p1 &lt; /path/to/make.patch</p>
<p><code class="docutils literal notranslate"><span class="pre">(patch can be found in ``\</span> <span class="pre">```https://www.redhat.com/archives/freeipa-users/2009-January/msg00022.html</span></code> &lt;<a class="reference external" href="https://www.redhat.com/archives/freeipa-users/2009-January/msg00022.html">https://www.redhat.com/archives/freeipa-users/2009-January/msg00022.html</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">, copy the contents and save it as make.patch)</span></code></p>
<ol class="arabic simple" start="5">
<li><p>Make rpms, the rpms will be in dist/rpms</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre"># make IPA_VERSION_IS_GIT_SNAPSHOT=no local-dist</span></code></p>
<p>–<a class="reference external" href="User:Viji">viji</a> 04:49, 15 January 2009 (EST)</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/Implementing_FreeIPA_in_a_mixed_Environment_(Windows\Linux)_-_Step_by_step.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>