<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Installing the IPA Server &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Overview" href="Integration_testing_configuration.html" />
    <link rel="prev" title="&lt;no title&gt;" href="ImproveOrRemove.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="installing-the-ipa-server">
<span id="id1"></span><h1>Installing the IPA Server<a class="headerlink" href="#installing-the-ipa-server" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>This page provides instructions on how to download the freeIPA server
software, and to get it installed and configured on your system. It also
provides information on common problems and possible solutions.</p>
<section id="assumptions">
<h3>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this heading">¶</a></h3>
<p>FreeIPA relies on a script to automate many of the installation tasks.
This script makes a number of assumptions.</p>
<ul>
<li><p><strong>System:</strong></p>
<p>That you are performing the installation on a “clean” system. The
script overwrites a number of files without prompting for
confirmation. <a class="reference external" href="#Configuring_the_IPA_Server">Configuring the FreeIPA
Server</a> lists the services whose
scripts and configuration files are modified.</p>
</li>
<li><p><strong>Directory Server:</strong></p>
<p>That there are no existing Directory Server instances. There is
currently no automatic upgrade facility from an existing Directory
Server. Any migration requirements should be referred to Red Hat
Global Professional Services.</p>
</li>
<li><p><strong>DNS:</strong></p>
<ul class="simple">
<li><p>That the server’s machine name is set, and that it resolves to its
public IP address (not to localhost).</p></li>
<li><p>That DNS is correctly configured to resolve forward and reverse
addresses. The DNS does not need to be on the same machine as the
IPA Server, but it does need to be fully functional.</p></li>
</ul>
</li>
</ul>
</section>
<section id="required-ports">
<span id="id2"></span><h3>Required Ports<a class="headerlink" href="#required-ports" title="Permalink to this heading">¶</a></h3>
<p>FreeIPA makes use of the following ports:</p>
<ul class="simple">
<li><p>TCP</p>
<ul>
<li><p>80, 443: HTTP/HTTPS</p></li>
<li><p>389, 636: LDAP/LDAPS</p></li>
<li><p>88, 464: Kerberos</p></li>
</ul>
</li>
<li><p>UDP</p>
<ul>
<li><p>88, 464: Kerberos</p></li>
<li><p>123: NTP</p></li>
</ul>
</li>
</ul>
<p>You need to ensure that these ports are available; that is, that they
are not assigned to another service. If these ports are not available,
IPA will not function correctly.</p>
</section>
<section id="file-systems">
<span id="id3"></span><h3>File Systems<a class="headerlink" href="#file-systems" title="Permalink to this heading">¶</a></h3>
<p>The default root directory for users’ home directories is <code class="docutils literal notranslate"><span class="pre">/home</span></code>, but
it is the responsibility of the system administrator to ensure that
whatever value is specified for this attribute is actually available.</p>
<p>Red Hat Enterprise Linux and most other Linux distributions include a
pam module called <em>pam_mkhomedir</em> that can be used to automatically
create a home directory if one does not exist for the user
authenticating against the system. IPA does not force the use of this
module because it may try to create home directories even when the
shared storage is simply not available. It is the responsibility of the
system administrator to activate this module on the clients if needed.</p>
<p>If a suitable directory and mechanism are not available for the creation
of home directories, users may not be able to log in successfully.</p>
</section>
<section id="dns">
<h3>DNS<a class="headerlink" href="#dns" title="Permalink to this heading">¶</a></h3>
<p>It is recommended that you use DNS to facilitate Service Discovery in
IPA. Service Discovery refers to the way that IPA clients find (or
<em>discover</em>) IPA servers. You can use the basic DNS configuration that is
provided with IPA to configure an existing DNS to work with IPA, or use
<code class="docutils literal notranslate"><span class="pre">--setup-bind</span></code> option to configure a new DNS. The DNS does not need to
be on the same machine as the IPA server, but it does need to be
correctly configured and fully functional.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">--setup-bind</span></code> option is an optional parameter that can be
passed to the <code class="docutils literal notranslate"><span class="pre">ipa-server-install</span></code> script. This is provided for
convenience only; it is not a supported aspect of IPA. The
following article may help you to configure your DNS server: <a class="reference external" href="http://www.redhat.com/magazine/025nov06/features/dns/">How
to set up a DNS
server</a></p>
</div></blockquote>
</div></blockquote>
<p>To aid in the creation and configuration of a suitable DNS setup, the
IPA installation creates a sample zone file. During the installation you
will see a message similar to the following:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Sample</span> <span class="pre">zone</span> <span class="pre">file</span> <span class="pre">for</span> <span class="pre">bind</span> <span class="pre">has</span> <span class="pre">been</span> <span class="pre">created</span> <span class="pre">in</span> <span class="pre">/tmp/sample.zone.F_uMf4.db</span></code></p>
</div></blockquote>
<p>You should use this file in your zone file in DNS. Further, you need to
ensure that your FQDN does not resolve to your loopback address.</p>
<section id="ipa-dns-and-nscd">
<span id="id4"></span><h4>IPA, DNS, and NSCD<a class="headerlink" href="#ipa-dns-and-nscd" title="Permalink to this heading">¶</a></h4>
<p>It is recommended that you avoid or restrict the use of nscd (Name
Service Caching Daemon) in an IPA deployment. While nscd is extremely
useful for reducing the load on the server, and for making clients more
responsive, there are also drawbacks to its use.</p>
<p>nscd performs caching operations for all services that perform queries
via the nsswitch interface, including getent. Because it performs both
positive and negative caching, if it determines that a specific IPA user
does not exist when a request is made, it marks this as a negative
cache. Values stored in the cache remain until the cache expires,
regardless of any changes that may have occurred on the server.</p>
<p>The results of such caching is that new users and memberships may not be
visible, and users and memberships that have been removed may still be
visible.</p>
<p>To alleviate the effects of this, you can avoid the use of nscd
altogether, or change the default settings to use a shorter cache time.
In particular, consider changing the following values in the
<code class="docutils literal notranslate"><span class="pre">/etc/nscd.conf</span></code> file to suit the usage patterns of your deployment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">positive</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">group</span>           <span class="mi">3600</span>
<span class="n">negative</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">group</span>           <span class="mi">60</span>
<span class="n">positive</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">hosts</span>           <span class="mi">3600</span>
<span class="n">negative</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span>   <span class="n">hosts</span>           <span class="mi">20</span>
</pre></div>
</div>
</section>
<section id="dns-and-kerberos">
<span id="id5"></span><h4>DNS and Kerberos<a class="headerlink" href="#dns-and-kerberos" title="Permalink to this heading">¶</a></h4>
<p>Kerberos, too, has very specific DNS requirements. Your Kerberos server
requires a proper DNS A record, and reverse DNS needs to work correctly.
Do not use CNAME or DDNS names, as it can cause major problems later.
The IPA installation process includes checks to ensure that the IPA
server name is a DNS A record and that its reverse matches its forward
address.</p>
<p>Refer to <a class="reference external" href="http://www.freeipa.com/page/IpaConcepts#IPA_and_DNS">IPA and
DNS</a> for more
information on how these technologies work together.</p>
</section>
</section>
<section id="configuring-etc-hosts">
<span id="configuring-etchosts"></span><h3>Configuring /etc/hosts<a class="headerlink" href="#configuring-etc-hosts" title="Permalink to this heading">¶</a></h3>
<p>You need to ensure that your <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> file is configured
correctly, or the <strong>ipa-*</strong> commands may not work correctly.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> file should list the FQDN for your IPA server
<em>before</em> any aliases. You should also ensure that the hostname is not
part of the localhost entry. The following is an example of a valid
hosts file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">127.0.0.1</span>       <span class="n">localhost</span><span class="o">.</span><span class="n">localdomain</span>   <span class="n">localhost</span>
<span class="p">::</span><span class="mi">1</span>     <span class="n">localhost6</span><span class="o">.</span><span class="n">localdomain6</span> <span class="n">localhost6</span>
<span class="mf">192.168.1.1</span>     <span class="n">ipaserver</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>      <span class="n">ipaserver</span>
</pre></div>
</div>
</section>
<section id="hardware-requirements">
<span id="id6"></span><h3>Hardware Requirements<a class="headerlink" href="#hardware-requirements" title="Permalink to this heading">¶</a></h3>
<p>The following table contains guidelines for Directory Server disk space
and memory requirements based on on the number of entries that your
organization requires. The values shown here assume that the entries in
the LDIF file are approximately 100 bytes each and that only the
recommended indices are configurable.</p>
<p>The system requirements for both 32-bit and 64-bit platforms are the
same.</p>
<table class="docutils align-default" id="id22">
<caption><span class="caption-text"><strong>Operating system hardware requirements for IPA 1.0 Server</strong></span><a class="headerlink" href="#id22" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Criteria</strong></p></th>
<th class="head"><p><strong>Requirements</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Operating System</p></td>
<td><p>Red Hat Enterprise Linux 5.1
Server or later, with the latest
patches and upgrades Fedora 7 or
later, with the latest patches
and upgrades</p></td>
</tr>
<tr class="row-odd"><td><p>CPU Type</p></td>
<td><p>Pentium 3 or higher; 500MHz or
higher</p></td>
</tr>
<tr class="row-even"><td><p>Required Memory</p></td>
<td><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Entries</strong></p></th>
<th class="head"><p><strong>RAM</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>10,000 -
250,000</p></td>
<td><p>256 MB
minimum</p></td>
</tr>
<tr class="row-odd"><td><p>250,000 -
1,000,000</p></td>
<td><p>512 MB
minimum</p></td>
</tr>
<tr class="row-even"><td><p>1,000,000 +</p></td>
<td><p>1 GB minimum</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p>Hard Disk</p></td>
<td><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Entries</strong></p></th>
<th class="head"><p><strong>Disk
Space</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>10,000 -
250,000</p></td>
<td><p>2GB</p></td>
</tr>
<tr class="row-odd"><td><p>250,000 -
1,000,000</p></td>
<td><p>4GB</p></td>
</tr>
<tr class="row-even"><td><p>1,000,000 +</p></td>
<td><p>8GB</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="installing-the-ipa-server-packages">
<span id="id7"></span><h2>Installing the IPA Server Packages<a class="headerlink" href="#installing-the-ipa-server-packages" title="Permalink to this heading">¶</a></h2>
<p>This document distinguishes between commands to be run as root versus a
regular user. Commands to be run as root are prefixed with a # symbol.
Commands to be run as a regular user are prefixed with a $ symbol.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>Before starting the freeIPA installation, ensure that you update
your system with all the latest packages.
If you are installing on 64-bit Red Hat Enterprise Linux 5.1, you
need to update the <strong>krb5libs</strong> package <em>before</em> you install the
<strong>ipa-server</strong> package.</p>
</div></blockquote>
</div></blockquote>
<p>1. freeIPA is currently only in the Fedora 7 and 8 updates-testing
repository. It is in the regular repository for rawhide (Fedora 9). To
install freeIPA you will need to enable the updates-testing repository.
You can do this either by editing the
<code class="docutils literal notranslate"><span class="pre">/etc/yum.repos.d/updates-testing.repo</span></code> file, or on the command line,
as shown in step 2:</p>
<ol class="arabic simple" start="2">
<li><p>Run the following command to install the IPA server packages:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># yum install --enablerepo=updates-testing ipa-server</span>
</pre></div>
</div>
<p>For Fedora 9 you do not need to include <code class="docutils literal notranslate"><span class="pre">--enablerepo=updates-testing</span></code></p>
<p>This will install a large number of dependencies, including
<strong>TurboGears</strong>, <strong>fedora-ds-base</strong> and <strong>krb5-server</strong>. Approximately 40
dependencies are required, depending on what is already installed.</p>
<p>3. freeIPA no longer requires a special <strong>mod_auth_kerb</strong> package but it
does require a specific version of <strong>krb5-libs</strong> which contains a fix
for Kerberos ticket delegation (look for “spnego” in the Changelog). The
dependency should be handled by the <strong>ipa-server</strong> rpm, but if you want
to verify manually, you need:</p>
<ul class="simple">
<li><p>Fedora 7: 1.6.1-7 or higher</p></li>
<li><p>Fedora 8: 1.6.2-11 or higher</p></li>
<li><p>Fedora 9: all versions should be ok</p></li>
</ul>
<p>If you previously installed the IPA-specific <strong>mod_auth_kerb</strong> package,
you can remove it and replace it with the default Fedora version and
ensure you have the minimum version of <strong>krb5-libs</strong> as listed above.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>If you are installing on Fedora 9, it is strongly recommend that
you <em>not</em> use <strong>NetworkManager</strong>. Instead, run the following
commands to use <strong>network</strong> to manage the network service:</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># chkconfig NetworkManager off</span>
<span class="c1"># chkconfig network on</span>
<span class="c1"># service network start</span>
</pre></div>
</div>
</div></blockquote>
<p>Now you are ready to configure your IPA server.</p>
</section>
<section id="configuring-the-ipa-server">
<span id="id8"></span><h2>Configuring the IPA Server<a class="headerlink" href="#configuring-the-ipa-server" title="Permalink to this heading">¶</a></h2>
<p>Use the <strong>ipa-server-install</strong> command to install the IPA server, which
includes:</p>
<ul class="simple">
<li><p>Configuring the Network Time Daemon (ntpd)</p></li>
<li><p>Creating and configuring an instance of Directory Server</p></li>
<li><p>Creating and configuring a Kerberos Key Distribution Center (krb5kdc)</p></li>
<li><p>Configuring Apache (httpd)</p></li>
<li><p>Configuring TurboGears</p></li>
<li><p>Updating the SELinux targeted policy</p></li>
</ul>
<p>You can install the server interactively by running the command with no
options, or by passing options directly to the <strong>ipa-server-install</strong>
command. To view the available command-line options, run
<code class="docutils literal notranslate"><span class="pre">/usr/sbin/ipa-server-install</span> <span class="pre">--help</span></code></p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>If you are running IPA as a virtualized guest, you should not run
the ntp daemon. In this case, you should pass the <em>-N</em> (no ntp)
option to the <strong>ipa-server-install</strong> command.</p>
</div></blockquote>
</div></blockquote>
<p><strong>To install the freeIPA server interactively:</strong></p>
<ol class="arabic">
<li><p>Run the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">ipa-server-install</span></code></p>
</li>
</ol>
<p>2. When prompted, enter the server host name, realm name and other
details.</p>
<blockquote>
<div><p>The installation script compares the hostname returned by DNS to the
hostname found in the <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> file. If the
non-fully–qualified domain name appears first, the script aborts.</p>
</div></blockquote>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>The hostname that you enter into the ipa-server-install script
must be the same as that returned by the hostname command,
otherwise the Directory Server cannot use its own keytab. This
results in commands such as ipa-finduser to fail.</p>
</div></blockquote>
</div></blockquote>
<p>3. Wait until the configuration script completes. Note that it can take
several minutes to set up and configure all of the freeIPA requirements.</p>
<p>4. When the configuration script has completed, you should either reboot
the server or at least restart the ssh server so that the Name Server
Switch (nss) configuration is read when the service restarts.</p>
<blockquote>
<div><p>To restart the ssh service, run the following command (existing
connections are not terminated):</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">service</span> <span class="pre">sshd</span> <span class="pre">restart</span></code></p>
</div></blockquote>
<p>You can now proceed to test the configuration.</p>
<section id="testing-the-configuration">
<span id="id9"></span><h3>Testing the Configuration<a class="headerlink" href="#testing-the-configuration" title="Permalink to this heading">¶</a></h3>
<p>The following examples assume that you are using EXAMPLE.COM as your
realm.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /> <strong>Note:</strong></p>
<blockquote>
<div><p>The realm is used as the base DN in the directory instance, so it
will be <em>dc=example,dc=com</em>.</p>
</div></blockquote>
</div></blockquote>
<p>When the installation is complete, all of the services should be
running. You can test your installation as follows:</p>
<ol class="arabic simple">
<li><p>Use the <strong>kinit</strong> command to request a Kerberos ticket:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ kinit admin
Password for admin@EXAMPLE.COM:
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Use the <strong>klist</strong> command to display the list of Kerberos tickets:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ klist
Ticket cache: FILE:/tmp/krb5cc_0
Default principal: admin@EXAMPLE.COM
Valid starting     Expires            Service principal
03/05/08 02:47:53  03/06/08 02:47:50  krbtgt/EXAMPLE.COM@EXAMPLE.COM
Kerberos 4 ticket cache: /tmp/tkt0
klist: You have no tickets cached
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Use the <strong>ipa user-find</strong> command to search for the admin user:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa-finduser admin
cn: Administrator
homedirectory: /home/admin
loginshell: /bin/bash
uid: admin
</pre></div>
</div>
<p>If you receive output similar to the following, ensure that DNS is
configured correctly:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Could</span> <span class="pre">not</span> <span class="pre">initialize</span> <span class="pre">GSSAPI:</span> <span class="pre">Unspecified</span> <span class="pre">GSS</span> <span class="pre">failure.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Minor</span> <span class="pre">code</span> <span class="pre">may</span> <span class="pre">provide</span> <span class="pre">more</span> <span class="pre">information/Server</span> <span class="pre">not</span> <span class="pre">found</span> <span class="pre">in</span> <span class="pre">Kerberos</span> <span class="pre">database.</span></code></div>
</div>
</section>
</section>
<section id="configuring-your-browser">
<span id="id10"></span><h2>Configuring your Browser<a class="headerlink" href="#configuring-your-browser" title="Permalink to this heading">¶</a></h2>
<p>Firefox can use your Kerberos credentials for authentication, but you
need to specify which domains you want to communicate with, and using
which attributes.</p>
<ol class="arabic simple">
<li><p>Open Firefox, and type “<a class="reference external" href="about:config">about:config</a>” in the Address Bar.</p></li>
<li><p>In the Search field, type “negotiate”.</p></li>
</ol>
<p>3. Ensure the following lines reflect your setup. Replace “example.com”
with your own IPA server’s domain, with a preceding period (.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">negotiate</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="n">trusted</span><span class="o">-</span><span class="n">uris</span>  <span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">network</span><span class="o">.</span><span class="n">negotiate</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="n">delegation</span><span class="o">-</span><span class="n">uris</span>  <span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">network</span><span class="o">.</span><span class="n">negotiate</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="n">using</span><span class="o">-</span><span class="n">native</span><span class="o">-</span><span class="n">gsslib</span> <span class="n">true</span>
</pre></div>
</div>
<p>4. In Firefox, navigate to your IPA server (use the fully-qualified
domain name, for example, <a class="reference external" href="http://ipaserver.example.com">http://ipaserver.example.com</a>). Ensure that
there are no Kerberos authentication errors, and that you can see and
interact with the Web interface.</p>
</section>
<section id="using-a-browser-on-another-system">
<span id="id11"></span><h2>Using a Browser on Another System<a class="headerlink" href="#using-a-browser-on-another-system" title="Permalink to this heading">¶</a></h2>
<p>Use the following procedure to set up a browser on another system that
already has Kerberos set up for a different realm.</p>
<p>1. Copy the <code class="docutils literal notranslate"><span class="pre">/etc/krb5.conf</span></code> file from the IPA server to the client
system. Do not overwrite the existing <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code> file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># scp /etc/krb5.conf root@ipaclient:/etc/krb5_ipa.conf</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>On the IPA client, open a terminal and run the following commands:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export KRB5_CONFIG=/etc/krb5_ipa.conf
$ kinit user@EXAMPLE.COM
$ /usr/bin/firefox
</pre></div>
</div>
<p>3. Configure the Firefox <strong>negotiate</strong> attributes as described in the
<a class="reference external" href="#Configuring_your_Browser">Configuring your Browser</a> section.</p>
<p>Now you should be able to connect to the IPA Web interface remotely.</p>
</section>
</section>
<section id="setting-up-multi-master-replication">
<span id="id12"></span><h1>Setting up Multi-Master Replication<a class="headerlink" href="#setting-up-multi-master-replication" title="Permalink to this heading">¶</a></h1>
<p>Replication is the mechanism by which directory data is automatically
copied from one Directory Server to another. Updates of any kind —
adding, modifying, or deleting entries — are automatically mirrored to
other Directory Servers using replication.</p>
<p>IPA 1.0 uses a number of scripts to install, configure, and manage
replica servers and replication agreements. These are discussed in the
following sections.</p>
<section id="preparing-the-replica-servers">
<span id="id13"></span><h2>Preparing the Replica Servers<a class="headerlink" href="#preparing-the-replica-servers" title="Permalink to this heading">¶</a></h2>
<p>Replica servers require much the same preparation as IPA servers. That
is, there should be no existing Directory Server installations, the
ports required by IPA must be free and available, and the server’s
machine name be set and resolve to its public IP address (not to
localhost). The replica server must also be able to contact the master
LDAP server, so DNS or a similar lookup system must be working
correctly.</p>
<p>Refer to <a class="reference external" href="#Introduction">Introduction to Installing IPA</a> for more
information about these and other considerations for installing an IPA
server.</p>
</section>
<section id="installing-the-server-packages">
<span id="id14"></span><h2>Installing the Server Packages<a class="headerlink" href="#installing-the-server-packages" title="Permalink to this heading">¶</a></h2>
<p>Follow the steps in <a class="reference external" href="#Installing_the_IPA_Server_Packages">Installing the IPA Server
Packages</a> to install all of the
required packages for the replica server.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>Do not run the <strong>ipa-server-install</strong> script on the replica
servers.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="creating-the-replica-information-file">
<span id="id15"></span><h2>Creating the Replica Information File<a class="headerlink" href="#creating-the-replica-information-file" title="Permalink to this heading">¶</a></h2>
<p>You need to create a <em>replica information file</em> for each replica that
you intend to create. This file contains various realm information
required to correctly configure the replica server.</p>
<p>Before you create the replica information file, you need to ensure that
the master IPA server is correctly configured and functioning properly.
The master IPA server is the server from which all IPA replica servers
will be created.</p>
<p><strong>To create the replica information file:</strong></p>
<p>Run the following command on the master IPA server, where
<em>ipareplica.example.com</em> is the FQDN of the server where you are going
to create the replica:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ipa-replica-prepare ipareplica.example.com</span>
</pre></div>
</div>
<p>This should produce output similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Determining</span> <span class="n">current</span> <span class="n">realm</span> <span class="n">name</span>
<span class="n">Getting</span> <span class="n">domain</span> <span class="n">name</span> <span class="kn">from</span> <span class="nn">LDAP</span>
<span class="n">Preparing</span> <span class="n">replica</span> <span class="k">for</span> <span class="n">ipareplica</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="kn">from</span> <span class="nn">ipaserver.example.com</span>
<span class="n">Creating</span> <span class="n">SSL</span> <span class="n">certificate</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Directory</span> <span class="n">Server</span>
<span class="n">Creating</span> <span class="n">SSL</span> <span class="n">certificate</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Web</span> <span class="n">Server</span>
<span class="n">Copying</span> <span class="n">additional</span> <span class="n">files</span>
<span class="n">Finalizing</span> <span class="n">configuration</span>
<span class="n">Packaging</span> <span class="n">the</span> <span class="n">replica</span> <span class="n">into</span> <span class="n">replica</span><span class="o">-</span><span class="n">info</span><span class="o">-</span><span class="n">ipareplica</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /> <strong>Note:</strong></p>
<blockquote>
<div><p>Each replica information file is created in the <code class="docutils literal notranslate"><span class="pre">/var/lib/ipa/</span></code>
directory, and named specifically for the replica server for which
it is intended. You cannot use the same replica information file
for multiple replicas.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="configuring-an-ipa-replica">
<span id="id16"></span><h2>Configuring an IPA Replica<a class="headerlink" href="#configuring-an-ipa-replica" title="Permalink to this heading">¶</a></h2>
<p>After you have created the replica information file, you need to copy it
to the replica server and run the required script to configure the
replica.</p>
<p><strong>To configure an IPA replica:</strong></p>
<ol class="arabic">
<li><p>Copy the replica information file to the replica server:</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">scp</span> <span class="pre">/var/lib/ipa/replica-info-ipareplica.example.com</span> <span class="pre">root&#64;ipareplica:/var/lib/ipa/</span></code></p>
</li>
</ol>
<p>2. On the replica server, run the replica installation script, passing
it the replica information file you copied from the master:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">ipa-replica-install</span> <span class="pre">/var/lib/ipa/replica-info-ipareplica.example.com</span></code></p>
<p>The replica installation script runs a test to ensure that the
replica file being installed matches the current hostname. If they do
not match, the script returns a warning message and asks for
confirmation. This could occur on a multi-homed machine, for example,
where mismatched hostnames may not be an issue.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Enter the Directory Manager (DM) password when prompted.</p></li>
</ol>
<p>The script then configures a directory server instance based on
information in the replica information file, and initiates a replication
process. When this has successfully completed, the script continues to
set up a complete master replica of the IPA server.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /> <strong>Note:</strong></p>
<blockquote>
<div><p>You can only have a single Directory Server instance on an IPA
server, the one used by IPA itself. If the replica installation
script detects an existing Directory Server instance, you will be
prompted to remove it.</p>
</div></blockquote>
</div></blockquote>
<section id="updating-dns-for-ipa-replicas">
<span id="id17"></span><h3>Updating DNS for IPA Replicas<a class="headerlink" href="#updating-dns-for-ipa-replicas" title="Permalink to this heading">¶</a></h3>
<p>After you have configured a new IPA replica, you should update your DNS
entries so that IPA clients can discover the new server. For example,
for an IPA replica with a server name of $HOST, you should add the
following entries to your zone file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>_ldap._tcp             IN SRV 0 100 389 $HOST
_kerberos._tcp         IN SRV 0 100 88 $HOST
_kerberos._udp         IN SRV 0 100 88 $HOST
_kerberos-master._tcp  IN SRV 0 100 88 $HOST
_kerberos-master._udp  IN SRV 0 100 88 $HOST
_kpasswd._tcp          IN SRV 0 100 464 $HOST
_kpasswd._udp          IN SRV 0 100 464 $HOST
_ntp._udp              IN SRV 0 100 123 $HOST
</pre></div>
</div>
</section>
</section>
<section id="managing-multi-master-replication">
<span id="id18"></span><h2>Managing Multi-Master Replication<a class="headerlink" href="#managing-multi-master-replication" title="Permalink to this heading">¶</a></h2>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">ipa-replica-manage</span></code> command to manage certain aspects
of replication between IPA servers. This includes listing, adding, and
deleting replication agreements, and also performing manual replication
initialization and updates.</p>
<p>Initialization is typically only required when you first set up
replication, or if a problem arises that causes replication to fail.
Initialization erases all data on the target replica and re-copies all
data from the master. That is, it completely destroys the database on
the consumer and rebuilds it with data from the master.</p>
<p>Sending updates is the regular incremental replication protocol.
Typically, this is not needed because the server sends changes when
required, provided that the replication agreement schedule allows it.</p>
<p>Refer to the <code class="docutils literal notranslate"><span class="pre">ipa-replica-manage</span></code> man page for a full description of
the available options.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /> <strong>Note:</strong></p>
<blockquote>
<div><p>There is no WebUI facility for managing IPA replicas. You need to
use the command line.</p>
</div></blockquote>
</div></blockquote>
<p>Refer to the <a class="reference external" href="http://www.redhat.com/docs/manuals/dir-server/ag/8.0/Managing_Replication.html">Managing
Replication</a>
section of the Red Hat Directory Server Administration Guide for
information about managing replication.</p>
</section>
<section id="troubleshooting-multi-master-replication">
<span id="id19"></span><h2>Troubleshooting Multi-Master Replication<a class="headerlink" href="#troubleshooting-multi-master-replication" title="Permalink to this heading">¶</a></h2>
<p>Refer to the following sections in the Red Hat Director Server
Administration Guide for information about troubleshooting replication:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.redhat.com/docs/manuals/dir-server/ag/8.0/Managing_Replication-Solving_Common_Replication_Conflicts.html">Solving Common Replication
Conflicts</a></p></li>
<li><p><a class="reference external" href="http://www.redhat.com/docs/manuals/dir-server/ag/8.0/Managing_Replication-Troubleshooting_Replication_Related_Problems.html">Troubleshooting Replication-Related
Problems</a></p></li>
</ul>
</section>
</section>
<section id="running-ipa-in-a-virtual-host">
<span id="id20"></span><h1>Running IPA in a Virtual Host<a class="headerlink" href="#running-ipa-in-a-virtual-host" title="Permalink to this heading">¶</a></h1>
<p>If you have a standard Apache instance running on port 80, you can
configure IPA to run on a secondary port, for example 8089. You should
be aware, however, that running IPA in this configuration does not use
SSL; all requests will go over standard HTTP.</p>
<section id="converting-your-ipa-configuration-to-run-as-a-virtualhost">
<span id="id21"></span><h2>Converting Your IPA Configuration to run as a VirtualHost<a class="headerlink" href="#converting-your-ipa-configuration-to-run-as-a-virtualhost" title="Permalink to this heading">¶</a></h2>
<p>The following procedure assumes you already have IPA configured to run
on port 80, and wish to move it to a different port.</p>
<ol class="arabic simple">
<li><p>Log in as the root user.</p></li>
</ol>
<p>2. Edit the <code class="docutils literal notranslate"><span class="pre">/etc/httpd/conf.d/ipa.conf</span></code> file. Add the following three
lines to the top of the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Listen</span> <span class="mi">8089</span>
<span class="n">NameVirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">8089</span>
<span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">8089</span><span class="o">&gt;</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Add the following line to the end of the file:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This wraps the entire IPA configuration in a VirtualHost, and ensures
that Apache is listening to that port.</p>
<blockquote>
<div><p><img alt="Note.png" src="../../_images/Note.png" /><strong>Note:</strong></p>
<blockquote>
<div><p>You can not use port 8080. This port is used by the <strong>ipa_webgui</strong>
service.</p>
</div></blockquote>
</div></blockquote>
<p>4. Comment out the following rewrite rules from the
<code class="docutils literal notranslate"><span class="pre">/etc/httpd/conf.d/ipa.conf</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------
# Redirect to the fully-qualified hostname. Not redirecting to secure
# port so configuration files can be retrieved without requiring SSL.
RewriteCond %{HTTP_HOST}    !^host.foo.com$ [NC]
RewriteRule ^/(.*)          http://host.foo.com/$1 [L,R=301]

# Redirect to the secure port if not displaying an error or retrieving
# configuration.
RewriteCond %{SERVER_PORT}  !^443$
RewriteCond %{REQUEST_URI}  !^/(errors|config|favicon.ico)
RewriteRule ^/(.*)          https://host.foo.com/$1 [L,R=301,NC]
---------------------------------------------------------------------
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Reload the <strong>httpd</strong> service.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># service httpd reload</span>
</pre></div>
</div>
<p>IPA should now be running on port 8089, leaving port 8080 free for your
normal web site.</p>
<p><a class="reference external" href="Category:Obsolete">Category:Obsolete</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/InstallAndDeploy.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>