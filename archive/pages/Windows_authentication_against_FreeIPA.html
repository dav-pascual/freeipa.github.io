<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Windows authentication against FreeIPA &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Step 1. Create our Group to be used for user validation" href="YubiRadius_integration_with_group-validated_FreeIPA_Users_using_LDAPS.html" />
    <link rel="prev" title="Wiki structure" href="Wiki_structure.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="windows-authentication-against-freeipa">
<span id="id1"></span><h1>Windows authentication against FreeIPA<a class="headerlink" href="#windows-authentication-against-freeipa" title="Permalink to this heading">¶</a></h1>
<p>This article describes direct integration between FreeIPA and Windows
machine, i.e. <strong>without involving Active Directory</strong> server. This
article <strong>does not</strong> apply to configurations where <a class="reference external" href="Trust">trust between AD and
FreeIPA</a> was established. Note also that the described
configuration is not supported by FreeIPA development team and also is
not supported by Red Hat Enterprise Linux Identity Management product. A
work on making possible to login to Windows machines already enrolled
into a trusted Active Directory forest is ongoing and is not available
yet in any released FreeIPA version.</p>
<ol class="arabic simple">
<li><p>If you already have AD we recommend using this system with AD and
using trusts between AD and IPA.</p></li>
<li><p>If you do not have AD then use Samba 4 instead of it. As of Samba
4.3, Samba AD can establish cross-realm trusts. The feature is still
incomplete and lacks proper access controls but it can be configured
to trust FreeIPA.</p></li>
<li><p>If neither of the two options work for you you can configure Windows
system to work directly with IPA as described below. It is an option
of last resort because IPA does not provide the services windows
client expects and FreeIPA development team does not support this
mode. If this is good enough for you, fine by us.</p></li>
<li><p>Build a native Windows client (cred provider) for IPA using latest
Kerberos. This would be really useful if someone does that because we
don’t have capacity to not build this ourselves. With the native OTP
support in IPA it becomes a real business opportunity to provide a
native 2FA inside enterprise across multiple platforms. But please do
it open source way otherwise we would not recommend you ;-)</p></li>
</ol>
<section id="freeipa-is-not-an-active-directory-server">
<span id="id2"></span><h2>FreeIPA is not an Active Directory server<a class="headerlink" href="#freeipa-is-not-an-active-directory-server" title="Permalink to this heading">¶</a></h2>
<p>FreeIPA is not a re-implementation of Microsoft Active Directory.
FreeIPA is focused on Linux (and other standards compliant) systems.</p>
<p>For this reason FreeIPA without configured <a class="reference external" href="Trusts">AD trust</a> can
provide only
<a class="reference external" href="http://en.wikipedia.org/wiki/Authentication">authentication</a> service
for Windows hosts (via standard <a class="reference external" href="http://en.wikipedia.org/wiki/Kerberos_%28protocol%29">Kerberos
protocol</a>).
FreeIPA can’t provide account database for Windows hosts in the same way
as AD does. You have to create local Windows account and appropriate
account mapping for each user if you select direct Windows&lt;=&gt;FreeIPA
integration. (This limitation doesn’t apply if you use <a class="reference external" href="Trusts">AD
trust</a>.)</p>
<p><a class="reference external" href="http://pgina.org/">Project pGina</a> could help you to overcome some
limitations.</p>
</section>
<section id="configure-freeipa">
<span id="id3"></span><h2>Configure FreeIPA<a class="headerlink" href="#configure-freeipa" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">1. Create the host principal in the web interface</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">2. Create IPA users to correspond to Windows users</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">3. Reset the user's IPA password to a known password using the web interface or CLI,</span></code></div>
<div class="line">``   the user will be prompted to change at first log in.``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">4. On the IPA server run</span></code></div>
<div class="line">`` ipa-getkeytab -s [kdc DNS name]``</div>
<div class="line">``               -p host/[machine-name]``</div>
<div class="line">``               -e  arcfour-hmac``</div>
<div class="line">``               -k krb5.keytab.[machine-name]``</div>
<div class="line">``               -P``</div>
<div class="line">`` At the prompt enter a random MACHINE_PASSWORD``</div>
<div class="line">`` (you will enter this later on the windows machine too).``</div>
<div class="line">`` <code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">**``Note:</span></code><a href="#id4"><span class="problematic" id="id5">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``you</span></code><a href="#id6"><span class="problematic" id="id7">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``can</span></code><a href="#id8"><span class="problematic" id="id9">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``change</span></code><a href="#id10"><span class="problematic" id="id11">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``the</span></code><a href="#id12"><span class="problematic" id="id13">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``-e</span></code><a href="#id14"><span class="problematic" id="id15">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``argument</span></code><a href="#id16"><span class="problematic" id="id17">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``to</span></code><a href="#id18"><span class="problematic" id="id19">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``include</span></code><a href="#id20"><span class="problematic" id="id21">``</span></a><a href="#id22"><span class="problematic" id="id23">``</span></a><a href="#id24"><span class="problematic" id="id25">``</span></a>also``**</div>
<div class="line">`` <code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">**``AES</span></code><a href="#id26"><span class="problematic" id="id27">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``enctypes</span></code><a href="#id28"><span class="problematic" id="id29">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``from</span></code><a href="#id30"><span class="problematic" id="id31">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``FreeIPA</span></code><a href="#id32"><span class="problematic" id="id33">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``2.1.4</span></code><a href="#id34"><span class="problematic" id="id35">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``and</span></code><a href="#id36"><span class="problematic" id="id37">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``higher.``**\</span> <span class="pre">`` (FreeIPA ticket ``\</span> <span class="pre">```2038</span></code> &lt;<a class="reference external" href="https://fedorahosted.org/freeipa/ticket/2038">https://fedorahosted.org/freeipa/ticket/2038</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">)</span></code></div>
</div>
<div class="line-block">
<div class="line">`` <code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">**``Note:</span></code><a href="#id38"><span class="problematic" id="id39">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``Windows</span></code><a href="#id40"><span class="problematic" id="id41">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``machines</span></code><a href="#id42"><span class="problematic" id="id43">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``names</span></code><a href="#id44"><span class="problematic" id="id45">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``cannot</span></code><a href="#id46"><span class="problematic" id="id47">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``exceed</span></code><a href="#id48"><span class="problematic" id="id49">``</span></a><code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">``15</span></code><a href="#id50"><span class="problematic" id="id51">``</span></a><a href="#id52"><span class="problematic" id="id53">``</span></a><a href="#id54"><span class="problematic" id="id55">``</span></a>characters``**</div>
<div class="line">``  – pointed out by Han Boetes on 2013-01-03 on freeipa-users mailing list``</div>
</div>
</section>
<section id="configure-windows-ksetup">
<span id="id56"></span><h2>Configure Windows (ksetup)<a class="headerlink" href="#configure-windows-ksetup" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">1. ksetup /setdomain [REALM NAME]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">2. ksetup /addkdc [REALM NAME] [kdc DNS name]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">3. ksetup /addkpasswd [REALM NAME] [kdc DNS name]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">4. ksetup /setcomputerpassword [MACHINE_PASSWORD] (the one used above)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">5. ksetup /mapuser * *</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">6. Run gpedit.msc, open the key called:</span></code></div>
<div class="line">`` “Network Security: Configure encryption types allowed for Kerberos”``</div>
<div class="line">`` under:``</div>
<div class="line">``   Computer Configuration``</div>
<div class="line">``     Windows Settings``</div>
<div class="line">``       Security Settings``</div>
<div class="line">``         Local Policies``</div>
<div class="line">``           Security Options``</div>
<div class="line">`` and deselect everything except RC4_HMAC_MD5``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">7. *** REBOOT ***</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">8. Add local user accounts for all users that need to be able to log in.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">9. Log in as [user]&#64;[REALM] with the initial password, you will be prompted</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">to change the password then logged in.</span></code></div>
</div>
<p><strong>Note: Configuring encryption types is not needed from FreeIPA 2.1.4
and higher.</strong> (FreeIPA ticket
<a class="reference external" href="https://fedorahosted.org/freeipa/ticket/2038">2038</a>)</p>
<hr class="docutils" />
<p>The FreeIPA team thanks ‘Jimmy’ for providing this information on the
<a class="reference external" href="https://www.redhat.com/archives/freeipa-users/2011-November/msg00156.html">freeipa-users</a>
mailing list. See mailing list archives for the original text. Several
amendments were made.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/Windows_authentication_against_FreeIPA.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>