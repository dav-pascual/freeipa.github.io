<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CVE-2013-0199: Cross-Realm Trust key leak &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CVE-2014-3566: POODLE: SSLv3 vulnerability" href="CVE-2014-3566.html" />
    <link rel="prev" title="CVE-2012-5484: MITM Attack during Join process" href="CVE-2012-5484.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="cve-2013-0199-cross-realm-trust-key-leak">
<span id="id1"></span><h1>CVE-2013-0199: Cross-Realm Trust key leak<a class="headerlink" href="#cve-2013-0199-cross-realm-trust-key-leak" title="Permalink to this heading">¶</a></h1>
<p>FreeIPA 3.0 introduced a Cross-Realm Kerberos trusts with Active
Directory, a feature that allows IPA administrators to create a Kerberos
trust with an AD. This allows IPA users to be able to access resources
in AD trusted domains and vice versa.</p>
<p>When the Kerberos trust is created, an outgoing and incoming keys are
stored in the IPA LDAP backend (in ipaNTTrustAuthIncoming and
ipaNTTrustAuthOutgoing attributes). However, the IPA LDAP ACIs allow
anonymous read acess to these attributes which could allow an
unprivileged user to read the keys. With these keys an attacker could
impersonate users and services of the opposite domain by crafting
special Kerberos tickets.</p>
</section>
<section id="affected-versions">
<span id="id2"></span><h1>Affected Versions<a class="headerlink" href="#affected-versions" title="Permalink to this heading">¶</a></h1>
<p>All 3.x versions.</p>
<p>The vulnerability is present only if AD Trusts are enabled and a trust
relationship is in place.</p>
</section>
<section id="impact">
<h1>Impact<a class="headerlink" href="#impact" title="Permalink to this heading">¶</a></h1>
<p>Medium</p>
</section>
<section id="acknowledgements">
<h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this heading">¶</a></h1>
<p>The bug was found by the FreeIPA team during an internal review.</p>
</section>
<section id="upgrade-instructions">
<span id="id3"></span><h1>Upgrade Instructions<a class="headerlink" href="#upgrade-instructions" title="Permalink to this heading">¶</a></h1>
<p>Administrators are advise to change their ACIs to block the
ipaNTTrustAuthIncoming and ipaNTTrustAuthOutgoing attributes from access
from non administrative users.</p>
<p>Once the new ACIs are in place it is recommended to change the trust
password. This can be accomplished by temporary deleting and then
recreating the trust agreement between the two domains using tha ipa
trust CLI commands.</p>
</section>
<section id="patches">
<h1>Patches<a class="headerlink" href="#patches" title="Permalink to this heading">¶</a></h1>
<p>A patch to resolve this issue is available through our git repository:
<a class="reference external" href="http://git.fedorahosted.org/cgit/freeipa.git/commit/?id=d5966bde802d8ef84c202a3e7c85f17b9e305a30">http://git.fedorahosted.org/cgit/freeipa.git/commit/?id=d5966bde802d8ef84c202a3e7c85f17b9e305a30</a></p>
<p>Applying the patch prevents further access to keys but does NOT change
the trust secret.</p>
<p><a class="reference external" href="Category:CVEs">Category:CVEs</a></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/CVE-2013-0199.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>