<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Theory &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="DNS updates and zone transfers with TSIG" href="DNS_updates_and_zone_transfers_with_TSIG.html" />
    <link rel="prev" title="Classless IN-ADDR.ARPA delegation" href="DNS_classless_IN-ADDR.ARPA_delegation.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><strong>Supported in IPA version 4.1 and newer</strong></p>
<section id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Permalink to this heading">¶</a></h1>
<p>Public internet contains root zone, handled by root servers. Recursive
servers needs the root hints, list of known addresses of root servers,
to be able send queries to the root servers.</p>
<p>In isolated you might want to have own root zone. This can be done by
setting up root zone (.) as master zone on IPA DNS server. If zone is
authoritative (master) root hints are not used by the IPA server.</p>
<p>Keep in mind that root hints have to be updated on all servers which are
not authoritative for the root zone, and also on recursive clients
inside the isolated network.</p>
</section>
<section id="example-how-to-create-root-zone">
<span id="id1"></span><h1>Example how to create root zone<a class="headerlink" href="#example-how-to-create-root-zone" title="Permalink to this heading">¶</a></h1>
<p>IPA DNS server: <em>ipa.example.com.</em></p>
<p>Add root zone (.):</p>
<p><code class="docutils literal notranslate"><span class="pre">$ ipa dnszone-add .</span></code></p>
<p>Without proper delegation of zone where nameserver is located, BIND will
show following error and will not load the root zone.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre"># journalctl -b -u named[-pkcs11]</span></code></div>
<div class="line">``  zone ./IN: NS ‘ipa.example.com’ has no address records (A or AAAA)``</div>
<div class="line">``  zone ./IN: not loaded due to errors.``</div>
</div>
<p><strong>Note:</strong> IPA adds all DNS capable IPA replicas as default NS records to
zone apex.</p>
<p>Add NS delegation for all child zones on server.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnszone-find --pkey-only</span></code></div>
<div class="line">``  Zone name: .``</div>
<div class="line">``  Zone name: <a href="#id2"><span class="problematic" id="id3">``</span></a><strong>``2.0.192.in-addr.arpa.``</strong></div>
<div class="line">``  Zone name: <a href="#id4"><span class="problematic" id="id5">``</span></a><strong>``example.com.``</strong></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Number of entries returned 3</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnsforwardzone-find --pkey-only</span></code></div>
<div class="line">``  Zone name: <a href="#id6"><span class="problematic" id="id7">``</span></a><strong>``fwzone.test.``</strong></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Number of entries returned 1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnsrecord-add . ``\</span> <span class="pre">**``2.0.192.in-addr.arpa.``**\</span> <span class="pre">`` --ns-rec=ipa.example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnsrecord-add . ``\</span> <span class="pre">**``example.com.``**\</span> <span class="pre">`` --ns-rec=ipa.example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnsrecord-add . ``\</span> <span class="pre">**``fwzone.test.``**\</span> <span class="pre">`` --ns-rec=ipa.example.com.</span></code></div>
</div>
</section>
<section id="updating-root-hints">
<span id="id8"></span><h1>Updating root hints<a class="headerlink" href="#updating-root-hints" title="Permalink to this heading">¶</a></h1>
<p>This procedure updates root hints for machines which are not
authoritative for the root zone. It has to be repeated every time you
change IP addresses of your root servers.</p>
<p>In this example, the IP address <code class="docutils literal notranslate"><span class="pre">192.0.2.1</span></code> is IP address of one of
your private root servers. Root hints file usually has the same format
as zone file, so output from dig command can be used directly.</p>
<p>For BIND 9:</p>
<p><code class="docutils literal notranslate"><span class="pre">$ dig &#64;192.0.2.1 . NS &gt; /var/named/named.ca</span></code></p>
<p>For Unbound:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ dig &#64;192.0.2.1 . NS &gt; /var/unbound/hints.ca</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># add option &quot;roothints: /var/unbound/hints.ca&quot; to &quot;server&quot; section</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># in /etc/unbound/unbound.conf</span></code></div>
</div>
<p>For Unbound utilities (drill etc.):</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ dig &#64;192.0.2.1 . NS &gt; /tmp/hints.ca</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># use -r option for every call of the command</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ drill -r /tmp/hints.ca</span></code></div>
</div>
</section>
<section id="dnssec">
<h1>DNSSEC<a class="headerlink" href="#dnssec" title="Permalink to this heading">¶</a></h1>
<p>Details how to use DNSSEC in isolated networks are described in article
<a class="reference external" href="Howto/DNSSEC#DNSSEC_in_isolated_networks">DNSSEC in isolated
networks</a>.</p>
<p><a class="reference external" href="Category:How_to">Category:How to</a> <a class="reference external" href="Category:Draft_documentation">Category:Draft
documentation</a></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/Howto/DNS_in_isolated_networks.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>