<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Multivalued_target_filters_in_permissions.html" />
    <link rel="prev" title="Overview" href="Migrating_existing_environments_to_Trust.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>In a replication topology there exist many replication agreements and to
monitor the state of these agreements each of the servers in the
topology has to be queried. With the deployment of the topology plugin
it is possible to have the complete view of the topology on any server.
This paper describes how the topology plugin functions can be etxended
to provide replication monitoring.</p>
</section>
<section id="use-cases">
<h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h1>
<p>TODO</p>
</section>
<section id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h1>
<p>The feature is implemented as an extension to the topology plugin. It
implements a query for replication state, which is propagated to all
servers in the topology, the result of the query is conatained in the
topology segments and can be listed or visualized by contacting any
server.</p>
<section id="new-attributes-in-topology-objects">
<span id="id1"></span><h2>New attributes in topology objects<a class="headerlink" href="#new-attributes-in-topology-objects" title="Permalink to this heading">¶</a></h2>
<p>The suffix and segment entries will be extended to manage monitoring
requests and responses</p>
<p>Extension of the ipaReplicationTopologyConfig entry:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">cn=</span></code><code class="docutils literal notranslate"><span class="pre">,cn=topology,</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">objectclass: ipaReplicationTopologyConfig</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ipaReplTopoConfigRoot: &lt; dn &gt;</span></code></div>
<div class="line"><a href="#id2"><span class="problematic" id="id3">``</span></a>ipaReplTopoMonitorRequest: ``</div>
</div>
<p>The request ID is used to map the monitoring responses to a request, to
trigger a new request a ldap replace operation for this attribute is
applied. A simple time stamp is used as requestID.</p>
<p>Extension to the ipaReplicationTopologySegment:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">cn: ``\</span> <span class="pre">``, cn=</span></code><code class="docutils literal notranslate"><span class="pre">,cn=topology,</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">objectclass: ipaReplicationTopologySegment</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ipaReplSegmenState;left : ``\</span> <span class="pre">``:</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ipaReplSegmenState;right : ``\</span> <span class="pre">``:</span></code></div>
</div>
<p>For each agreement a replication state attribute is added “;left”
“;right” indicate to which of the two agreements that can be represented
by a segment the information refers</p>
</section>
<section id="plugin-operation">
<span id="id4"></span><h2>plugin operation<a class="headerlink" href="#plugin-operation" title="Permalink to this heading">¶</a></h2>
<p>The topology plugin monitors updates to the ipaReplTopoMonitorRequest
attribute, if this attribute is replaced wit a new monitoringID it
checks the status of the local agreements and updates the
ipaReplTopoState attributes in the corresponding segments. These updates
will be replicated to the other replicas</p>
</section>
<section id="monitoring-procedure">
<span id="id5"></span><h2>Monitoring procedure<a class="headerlink" href="#monitoring-procedure" title="Permalink to this heading">¶</a></h2>
<p>A client, CLI or GUI, initiates a monitoring cycle by modifying the
ipaReplTopoMonitorRequest attribute on one server. It then contacts
this, or any otehr, server and reads the topology segments for the
monitored suffix. It may take some time until the state information has
been updated on all servers and finally replicated, so this maybe has to
be repeated until a defined maximal waiting period passed.</p>
<p>Based on the received information, the state of the agreements can be
listed. The state of the agreement will be:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">green: the agrement is operational</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">red: agreement is not working (no more refinements yet)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">grey: no response for the monitoring request with the given monitoringID was received</span></code></div>
</div>
</section>
<section id="required-actions">
<span id="id6"></span><h2>Required actions<a class="headerlink" href="#required-actions" title="Permalink to this heading">¶</a></h2>
<p>If all agreements are “green”, no actions required</p>
<p>For “red” agreements further investigation on the affected serves is
required.</p>
<p>If “grey” agreements exist, this means that part of the topology cannot
be reached by the server where the monitoring request was issued. Send
the monitoring request with the same monitoringID to a server in the
“grey” area, and merge the monitoring information for a more complete
picture of replication state.</p>
</section>
</section>
<section id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">¶</a></h1>
<p>Any implementation details you would like to spell out. Describe any
technical details here. Make sure you cover</p>
<ul class="simple">
<li><p><strong>Dependencies</strong>: any new dependencies that FreeIPA project or it’s
part would gain and that needs to be packaged in distros?</p></li>
<li><p><strong>Backup and Restore</strong>: any new file to back up or change required in
<a class="reference external" href="V3/Backup_and_Restore">Backup and Restore</a>?</p></li>
</ul>
<p>If this section is not trivial, move it to <code class="docutils literal notranslate"><span class="pre">/Implementation</span></code> sub page
and only include link.</p>
</section>
<section id="feature-management">
<h1>Feature Management<a class="headerlink" href="#feature-management" title="Permalink to this heading">¶</a></h1>
<section id="ui">
<h2>UI<a class="headerlink" href="#ui" title="Permalink to this heading">¶</a></h2>
<p>TODO</p>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Permalink to this heading">¶</a></h2>
<p>TODO</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
<p>TODO</p>
</section>
</section>
<section id="upgrade">
<h1>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this heading">¶</a></h1>
<p>TODO</p>
</section>
<section id="how-to-test">
<span id="how-to-test30"></span><h1>How to Test<a class="headerlink" href="#how-to-test" title="Permalink to this heading">¶</a></h1>
<p>TODO</p>
</section>
<section id="test-plan">
<span id="test-plan30"></span><h1>Test Plan<a class="headerlink" href="#test-plan" title="Permalink to this heading">¶</a></h1>
<p>TODO</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V4/Monitor_Replication_Topology.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>