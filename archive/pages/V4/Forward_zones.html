<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="FreeIPA-on-FIPS.html" />
    <link rel="prev" title="Overview" href="Firewall_Configuration.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>Forward zones allow to configure the name server to use forwarding only
for a particular zone.</p>
<p>In older versions of IPA, to allow forwarding per zone, was required to
create master zone with forward statement together with unnecessary
records. Current implementation allows separate forward and master zones
in FreeIPA <a class="reference external" href="DNS">DNS</a> to follow BIND design and achieve consistent
behavior.</p>
</section>
<section id="use-cases">
<h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h1>
<section id="forwarding-queries-per-a-zone">
<span id="id1"></span><h2>Forwarding queries per a zone<a class="headerlink" href="#forwarding-queries-per-a-zone" title="Permalink to this heading">¶</a></h2>
<p>Generally using global forwarders is all or nothing solution. Using
forward zones give more control to admin, which zones and how should be
forwarded.</p>
<section id="forwarding-policy-in-forward-and-master-zones">
<span id="id2"></span><h3>Forwarding policy in forward and master zones<a class="headerlink" href="#forwarding-policy-in-forward-and-master-zones" title="Permalink to this heading">¶</a></h3>
<p>Forwarding follows BIND design, here is short overview in table bellow,
for more information please read <a class="reference external" href="http://ftp.isc.org/isc/bind9/cur/9.9/doc/arm/Bv9ARM.ch06.html#id2583443">BIND
manual</a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>IPA forward-policy</p></th>
<th class="head"><p>behavior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>none</p></td>
<td><ol class="arabic simple">
<li><p>search local database for an
authoritative answer</p></li>
<li><p>if local server is
authoritative, return the
answer (including NXDOMAIN if
DNS name was not found)</p></li>
<li><p>if local server is not
authoritative, try only
recursion (if recursion is
allowed), no forwarding</p></li>
<li><p>return an answer obtained by
recursion</p></li>
</ol>
</td>
</tr>
<tr class="row-odd"><td><p>first (or as default)</p></td>
<td><ol class="arabic simple">
<li><p>search local database for an
authoritative answer</p></li>
<li><p>if local server is
authoritative, return the
answer (including NXDOMAIN if
DNS name was not found)</p></li>
<li><p>if local server is not
authoritative, try to query
forwarders</p></li>
<li><p>if query to forwarders failed,
try recursion (if recursion is
allowed)</p></li>
<li><p>return an answer from
forwarder or recursion</p></li>
</ol>
</td>
</tr>
<tr class="row-even"><td><p>only</p></td>
<td><ol class="arabic simple">
<li><p>search local database for an
authoritative answer</p></li>
<li><p>if local server is
authoritative, return the
answer (including NXDOMAIN if
DNS name was not found)</p></li>
<li><p>if local server is not
authoritative, try to query
forwarders</p></li>
<li><p>return an answer from
forwarders or return SERVFAIL
(if designated forwarders did
not reply)</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
</section>
<section id="avoid-an-ineffective-forward-zone">
<span id="id3"></span><h3>Avoid an ineffective forward zone<a class="headerlink" href="#avoid-an-ineffective-forward-zone" title="Permalink to this heading">¶</a></h3>
<p>Be careful using following set of zones, where a master zone exists for
a forward zone.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnszone-add example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">$ ipa dnsforwardzone-add  fw.example.com. --forwarder 192.0.2.1</span></code></div>
</div>
<p>In this case, forwarding will not work, because zone <em>example.com.</em> is
authoritative, and server return NXDOMAIN answer. To make forward zone
effective, you need delegate this forward domain using NS record to
different name server.</p>
<p>To add proper NS record use following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">$ ipa dnsrecord-add example.com. fw --ns-rec=</span></code></p>
</section>
</section>
</section>
<section id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h1>
<p>No changes for master zones required (‘idnsZone’ objectclass).</p>
<p>Forward zone will use own objectclass ‘idnsForwardZone’. (see below).</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">objectClass ( 2.16.840.1.113730.3.8.6.3</span></code></div>
<div class="line">``   NAME ‘idnsForwardZone’``</div>
<div class="line">``   DESC ‘Forward Zone class’``</div>
<div class="line">``   SUP top``</div>
<div class="line">``   STRUCTURAL``</div>
<div class="line">``   MUST ( idnsName $ idnsZoneActive )``</div>
<div class="line">``   MAY ( idnsForwarders $ idnsForwardPolicy ) )``</div>
</div>
<p>The idnsName, idnsZoneActive, idnsForwarders, idnsForwardPolicy are the
same attributes as the ‘idnsZone’ objectclass uses.</p>
<p>Both types are stored in LDAP, under <code class="docutils literal notranslate"><span class="pre">idnsname=$DOMAIN,cn=dns,$SUFFIX</span></code>
Only one zone type can be stored under the same name. (To add forward
zone with same name you must remove master zone and vice versa)</p>
<p>Forward zones are enabled by default.</p>
<section id="forward-policy">
<span id="id4"></span><h2>Forward Policy<a class="headerlink" href="#forward-policy" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">forward-policy</span> <span class="pre">=</span> <span class="pre">{first,</span> <span class="pre">only,</span> <span class="pre">none}</span></code>, default: <strong>first</strong></p>
<ul class="simple">
<li><p><strong>none</strong> - disable forwarding, forwarders are not required</p></li>
<li><p><strong>only</strong> - forward queries to forwarders (<strong>require</strong> to specify
<strong>forwarders</strong>)</p></li>
<li><p><strong>first</strong> - forward queries, if unanswered try to answer the query
(<strong>require</strong> to specify <strong>forwarders</strong>)</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>IPA</p></th>
<th class="head"><p>Bind</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>none</p></td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">zone &quot;fwd.test.&quot; in {</span></code></div>
<div class="line">``  type forward;``</div>
<div class="line">``  forwarders { };``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">};</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>first (or as default)</p></td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">zone &quot;fwd.test.&quot; in {</span></code></div>
<div class="line">``  type forward;``</div>
<div class="line">``  forwarders { <code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">`` };</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">};</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>only</p></td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">zone &quot;fwd.test.&quot; in {</span></code></div>
<div class="line">``  type forward;``</div>
<div class="line">``  forward only;``</div>
<div class="line">``  forwarders { <code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">`` };</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">};</span></code></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="new-ipa-commands">
<span id="id5"></span><h2>New IPA commands<a class="headerlink" href="#new-ipa-commands" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-add</span></code>, to add a new forward zone</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-mod</span></code>, to modify a forward zone</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-show</span></code>, to show a forward zone</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-find</span></code>, to find a forward zone(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-del</span></code>, to delete a forward zone(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-enable</span></code>, to enable a forward zone(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-disable</span></code>, to disable a forward zone(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-add-permission</span></code>, to add the permission for per
forward zone access delegation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-remove-permission</span></code>, to remove the permission for
per forward zone access delegation</p></li>
</ul>
</section>
</section>
<section id="feature-management">
<h1>Feature Management<a class="headerlink" href="#feature-management" title="Permalink to this heading">¶</a></h1>
<section id="ui">
<h2>UI<a class="headerlink" href="#ui" title="Permalink to this heading">¶</a></h2>
<p>A new page <em>Network Services/DNS/DNS Forward Zones</em> in WebUI. This page
handle all required operations: show current list of forward zones, add
a new forward zone, delete a forward zone, display a forward zone,
allows to modify forwarders and forward policy per a forward zone,
disable/enable a forward zone.</p>
<p>Forward zone consists of a name, forwarders, forwarding policy, and
enabled/disabled status</p>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Permalink to this heading">¶</a></h2>
<section id="dnsforwardzone">
<span id="id6"></span><h3>dnsforwardzone-*<a class="headerlink" href="#dnsforwardzone" title="Permalink to this heading">¶</a></h3>
<p>Args <code class="docutils literal notranslate"><span class="pre">--forwarder</span></code>, <code class="docutils literal notranslate"><span class="pre">--forward-policy</span></code>, <code class="docutils literal notranslate"><span class="pre">--name-from-ip</span></code> have same
behavior as they have in dnszone-* commands.</p>
<p>Forward zone name has same restrictions as in the master zone
(dnszone-<a href="#id7"><span class="problematic" id="id8">*</span></a>).</p>
</section>
<section id="dnsforwardzone-add">
<span id="id9"></span><h3>dnsforwardzone-add<a class="headerlink" href="#dnsforwardzone-add" title="Permalink to this heading">¶</a></h3>
<p>will add a new forward zone. Is required to specify at least one
forwarder if forward-policy is not ‘none’.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-add zone.test. --forwarder=172.16.0.1 --forwarder=172.16.0.2 --forward-policy=first</span></code></div>
<div class="line">``  Zone name: zone.test.``</div>
<div class="line">``  Zone forwarders: 172.16.0.1, 172.16.0.2``</div>
<div class="line">``  Forward policy: first``</div>
</div>
</section>
<section id="dnsforwardzone-mod">
<span id="id10"></span><h3>dnsforwardzone-mod<a class="headerlink" href="#dnsforwardzone-mod" title="Permalink to this heading">¶</a></h3>
<p>will modify a forward zone. Is required to specify at least one
forwarder if forward-policy is not ‘none’. Modifications can be
performed in several ways.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-mod zone.test. --forwarder=172.16.0.3</span></code></div>
<div class="line">``  Zone name: zone.test.``</div>
<div class="line">``  Zone forwarders: 172.16.0.3``</div>
<div class="line">``  Forward policy: first``</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-mod zone.test. --forward-policy=only</span></code></div>
<div class="line">``  Zone name: zone.test.``</div>
<div class="line">``  Zone forwarders: 172.16.0.3``</div>
<div class="line">``  Forward policy: only``</div>
</div>
</section>
<section id="dnsforwardzone-show">
<span id="id11"></span><h3>dnsforwardzone-show<a class="headerlink" href="#dnsforwardzone-show" title="Permalink to this heading">¶</a></h3>
<p>will show specified forward zone</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-show zone.test.</span></code></div>
<div class="line">``  Zone name: zone.test.``</div>
<div class="line">``  Zone forwarders: 172.16.0.5``</div>
<div class="line">``  Forward policy: first``</div>
</div>
</section>
<section id="dnsforwardzone-find">
<span id="id12"></span><h3>dnsforwardzone-find<a class="headerlink" href="#dnsforwardzone-find" title="Permalink to this heading">¶</a></h3>
<p>will find specified forward zone</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-find zone.test.</span></code></div>
<div class="line">``  Zone name: zone.test.``</div>
<div class="line">``  Zone forwarders: 172.16.0.3``</div>
<div class="line">``  Forward policy: first``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Number of entries returned 1</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
</div>
</section>
<section id="dnsforwardzone-del">
<span id="id13"></span><h3>dnsforwardzone-del<a class="headerlink" href="#dnsforwardzone-del" title="Permalink to this heading">¶</a></h3>
<p>will delete specified forward zone(s)</p>
<div class="line-block">
<div class="line"><a href="#id14"><span class="problematic" id="id15">``</span></a>dnsforwardzone-del zone.test. ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Deleted forward DNS zone &quot;zone.test.&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
</div>
</section>
<section id="dnsforwardzone-enable">
<span id="id16"></span><h3>dnsforwardzone-enable<a class="headerlink" href="#dnsforwardzone-enable" title="Permalink to this heading">¶</a></h3>
<p>will enable specified forward zone(s) NOTE: Forward zones are enabled by
default.</p>
<div class="line-block">
<div class="line"><a href="#id17"><span class="problematic" id="id18">``</span></a>dnsforwardzone-enable zone.test. ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Enabled forward DNS zone &quot;zone.test.&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
</div>
</section>
<section id="dnsforwardzone-disable">
<span id="id19"></span><h3>dnsforwardzone-disable<a class="headerlink" href="#dnsforwardzone-disable" title="Permalink to this heading">¶</a></h3>
<p>will disable specified forward zone(s)</p>
<div class="line-block">
<div class="line"><a href="#id20"><span class="problematic" id="id21">``</span></a>dnsforwardzone-disable zone.test. ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Disabled forward DNS zone &quot;zone.test.&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">----------------------------</span></code></div>
</div>
</section>
<section id="dnsforwardzone-add-permission">
<span id="id22"></span><h3>dnsforwardzone-add-permission<a class="headerlink" href="#dnsforwardzone-add-permission" title="Permalink to this heading">¶</a></h3>
<p>will add system permission</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-add-permission zone.test.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Added system permission &quot;Manage DNS zone zone.test.&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------------</span></code></div>
<div class="line">``  Manage DNS zone zone.test.``</div>
</div>
</section>
<section id="dnsforwardzone-remove-permission">
<span id="id23"></span><h3>dnsforwardzone-remove-permission<a class="headerlink" href="#dnsforwardzone-remove-permission" title="Permalink to this heading">¶</a></h3>
<p>will remove system permission</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dnsforwardzone-remove-permission zone.test.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------------</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Removed system permission &quot;Manage DNS zone zone.test.&quot;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">---------------------------------------------------------</span></code></div>
<div class="line">``  Manage DNS zone zone.test.``</div>
</div>
</section>
</section>
</section>
<section id="updates-and-upgrades">
<h1>Updates and Upgrades<a class="headerlink" href="#updates-and-upgrades" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>idnsForwardZone objectclass is already supported by bind-dyndb-ldap
&gt;= 3.5. This covers also RHEL/CentOS &gt;= 7.0 so upgrades involving
only RHEL 7.x machines are seamless.</p></li>
<li><p>Unfortunatelly, we did not realize that interaction with RHEL/CentOS
&lt; 7.0 &amp;&amp; RHEL/CentOS &gt;= 7.1 in the same topology will not be
seamless. (See <a class="reference external" href="https://bugzilla.redhat.com/show_bug.cgi?id=1175318">bug
1175318</a>.)</p>
<ul>
<li><p>RHEL 7.1 ships bind-dyndb-ldap &gt;= 6.0 which relies on new object
semantics which is not supported by bind-dyndb-ldap 2.3 shipped
with RHEL 6.6. As a result, forward zones will stop working on old
replicas as soon as RHEL 7.1 upgrade procedure is executed.</p></li>
<li><p>Solution is to patch bind-dyndb-ldap in RHEL 6.6.z and add support
for idnsForwardZone object class to it (see <a class="reference external" href="https://bugzilla.redhat.com/show_bug.cgi?id=1176129">bug
1176129</a>).
It will allow RHEL 6.6.z+ replicas to continue to work after RHEL
7.1+ is joined to the topology.</p></li>
<li><p>Assumption is that from a moment of upgrade to RHEL 7.1+ on all
forward zones are managed from RHEL 7.1+ replicas (so the data are
stored in the new format).</p></li>
</ul>
</li>
<li><p>add idnsForwardZone objectclass to LDAP schema</p></li>
<li><p>All zones with configured forwarders and forward-policy not equal to
none, will be moved to idnsForwardZone objectclass, and idnsZone
class will be removed. First, the zones will be exported to LDIF as
backup in <strong>/var/lib/ipa/backup/</strong> directory, named as
<strong>dns-forward-zones-backup-%Y-%m-%d-%H-%M-%S.ldif</strong></p></li>
</ul>
<table class="docutils align-default" id="id32">
<caption><span class="caption-text">Migration table</span><a class="headerlink" href="#id32" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>forward-policy</p></th>
<th class="head"><p>none</p></th>
<th class="head"><p>first</p></th>
<th class="head"><p>only</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>forwarders</p></td>
<td><p>master</p></td>
<td><p>forward</p></td>
<td><p>forward</p></td>
<td><p>forward</p></td>
</tr>
<tr class="row-odd"><td><p>no forwarders</p></td>
<td><p>master</p></td>
<td><p>master</p></td>
<td><p>master</p></td>
<td><p>master</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Transformation to forward zones, is executed only once, by one
replica only, and only if ipa version is lower than 4.0. This is
ensured by detection: if ‘idnsforwardzone’ objectclass is presented
in schema before schema upgrade, then no transformation is required,
else transform master zone to forward zone using rules above.</p></li>
</ul>
</section>
<section id="how-to-test">
<span id="how-to-test20"></span><h1>How to Test<a class="headerlink" href="#how-to-test" title="Permalink to this heading">¶</a></h1>
<section id="basic-configuration">
<span id="id24"></span><h2>Basic configuration<a class="headerlink" href="#basic-configuration" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>install <em>IPA server</em> with DNS, do not set up forwarders</p></li>
<li><p>Set up an <em>external DNS server</em> (IP: 192.0.2.200)</p></li>
<li><p>Configure zone <em>example.test.</em> on <em>external DNS server</em></p></li>
<li><p>Add A record <em>host.example.test. IN A 192.0.2.111</em> into zone
<em>example.test.</em> on <em>external DNS server</em></p></li>
</ol>
</section>
<section id="test-a-forward-zone-with-forwarding-only-policy">
<span id="id25"></span><h2>Test a forward zone with forwarding only policy<a class="headerlink" href="#test-a-forward-zone-with-forwarding-only-policy" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>use the basic configuration above</p></li>
<li><p>test zone <em>example.test</em> using dig: <strong>$ dig &#64; A host.example.test.</strong></p></li>
<li><p>expected result: NXDOMAIN</p></li>
<li><p>add forward zone on <em>IPA server</em>: <strong>$ ipa dnsforwardzone-add
example.test. –forward-policy=only –forwarder=192.0.2.200</strong></p></li>
<li><p>test zone <em>example.test</em> using dig: <strong>$ dig &#64; A host.example.test.</strong></p></li>
<li><p>expected result: <em>host.example.test. IN A 192.0.2.111</em> record in the
answer, AUTHORITY SECTION is pointing to <em>external DNS server</em></p></li>
</ol>
</section>
<section id="test-a-forward-zone-with-forwarding-none-policy">
<span id="id26"></span><h2>Test a forward zone with forwarding none policy<a class="headerlink" href="#test-a-forward-zone-with-forwarding-none-policy" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>use the basic configuration above</p></li>
<li><p>test zone <em>example.test</em> using dig: <strong>$ dig &#64; A host.example.test.</strong></p></li>
<li><p>expected result: NXDOMAIN</p></li>
<li><p>add global forwarder (external DNS server): <strong>ipa dnsconfig-mod
–forwarder=192.168.2.200</strong></p></li>
<li><p>test zone <em>example.test</em> using dig: <strong>$ dig &#64; A host.example.test.</strong></p></li>
<li><p>expected result: <em>host.example.test. IN A 192.0.2.111</em> record in the
answer, AUTHORITY SECTION is pointing to <em>external DNS server</em></p></li>
<li><p>add forward zone with none policy: <strong>$ ipa dnsforward-zone
example.test. –forward-policy=none</strong></p></li>
<li><p>test zone <em>example.test</em> using dig: <strong>$ dig &#64; A host.example.test.</strong></p></li>
<li><p>expected result: NXDOMAIN</p></li>
</ol>
</section>
</section>
<section id="test-plan">
<h1>Test Plan<a class="headerlink" href="#test-plan" title="Permalink to this heading">¶</a></h1>
<section id="unit-tests">
<span id="id27"></span><h2>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Create forward zone:</p>
<ul>
<li><p><strong>dnsforwardzone-add fw-zone</strong></p>
<ul>
<li><p>Expectation: missing forwarders, ValidationError</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-add fw-zone –forward-policy=only</strong></p>
<ul>
<li><p>Expectation: missing forwarders, ValidationError</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-add fw-zone –forward-policy=none</strong></p>
<ul>
<li><p>Expectation: add fw-zone with policy none, no forwarders</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-add fw-zone –forwarder=172.16.15.1</strong></p>
<ul>
<li><p>Expectation: add fw-zone with policy first, forwarder
172.16.15.1</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-add fw-zone –forwarder=172.16.15.1
–forward-policy=only</strong></p>
<ul>
<li><p>Expectation: add fw-zone with policy only, forwarder
172.16.15.1</p></li>
</ul>
</li>
<li><p><strong>Try to add duplicated zone</strong></p>
<ul>
<li><p>Expectation: DuplicationError</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Modify forward zone</p>
<ul>
<li><p><strong>dnsforwardzone-mod fw-zone-without-forwarders
–forward-policy=only</strong></p>
<ul>
<li><p>Expectation: missing forwarders, ValidationError</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-mod fw-zone-without-forwarders
–forward-policy=first</strong></p>
<ul>
<li><p>Expectation: missing forwarders, ValidationError</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-mod fw-zone-policy-none
–forwarder={172.16.15.1,172.16.15.2}</strong></p>
<ul>
<li><p>Expectation: zone policy=none, forwarders: 172.16.15.1,
172.16.15.2</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-mod fw-zone-with-forwarders
–forward-policy=first</strong></p>
<ul>
<li><p>Expectation: zone policy=first, forwarders=</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-mod fw-zone-with-forwarders
–forward-policy=only</strong></p>
<ul>
<li><p>Expectation: zone policy=only, forwarders=</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Show forward zone</p>
<ul>
<li><p><strong>dnsforwardzone-show fw-zone</strong></p>
<ul>
<li><p>Expectation: retrieve zone</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Find forward zone</p>
<ul>
<li><p><strong>dnsforwardzone-find</strong></p>
<ul>
<li><p>Expectation: show all forward zones matching expression</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Disable/Enable forward zone</p>
<ul>
<li><p><strong>dnsforwardzone-enable fw-zone</strong></p>
<ul>
<li><p>Expectation: fw-zone becomes enabled</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-disable fw-zone</strong></p>
<ul>
<li><p>Expectation: fw-zone becomes disabled</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Add/Remove per-zone permission</p>
<ul>
<li><p><strong>dnsforwardzone-add-permision fw-zone</strong></p>
<ul>
<li><p>Expectation: create system permission for fw-zone</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-remove-permission fw-zone</strong></p>
<ul>
<li><p>Expectation: remove system permission for fw-zone</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Delete forward zone</p>
<ul>
<li><p><strong>dnszone-del fw-zone</strong></p>
<ul>
<li><p>Expectation: Zone is removed</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Mutual exclusion with master zones (<a href="#id28"><span class="problematic" id="id29">*</span></a>-add)</p>
<ul>
<li><p><strong>dnszone-add zone-exists-as-forward</strong></p>
<ul>
<li><p>Expectation: DuplicateError</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-add zone-exists-as-master</strong></p>
<ul>
<li><p>Expectation: DuplicateError</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Mutual exclusion with master zones (<a href="#id30"><span class="problematic" id="id31">*</span></a>-find)</p>
<ul>
<li><p><strong>dnszone-find</strong></p>
<ul>
<li><p>Expectation: Lists ONLY master zones</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-find</strong></p>
<ul>
<li><p>Expectation: LIsts ONLY forward zones</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Mutual exclusion with master zones (others)</p>
<ul>
<li><p><strong>dnszone-* forward-zone</strong></p>
<ul>
<li><p>Expectation: NotFound Error</p></li>
</ul>
</li>
<li><p><strong>dnsforwardzone-* master-zone</strong></p>
<ul>
<li><p>Expectation: NotFound Error</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Prevent dnsrecord-* commands work with forwardzone</p>
<ul>
<li><p><strong>dnsrecord-* forward-zone</strong></p>
<ul>
<li><p>Expectation: ValidationError: only master zones can contain
records</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="rfe-author">
<h1>RFE Author<a class="headerlink" href="#rfe-author" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="User:Mbasti">mbasti</a></p>
<p><a class="reference external" href="Category:FreeIPA_V4_Test_Plan">Category:FreeIPA V4 Test Plan</a>
<a class="reference external" href="Category:FreeIPA_Test_Plan">Category:FreeIPA Test Plan</a></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V4/Forward_zones.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>