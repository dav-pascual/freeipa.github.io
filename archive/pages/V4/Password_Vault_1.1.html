<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Password_Vault_1.2.html" />
    <link rel="prev" title="Overview" href="Password_Vault_1.0.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>Password Vault 1.1 provides several enhancements over <a class="reference external" href="V4/Password_Vault_1.0">Password Vault
1.0</a>.</p>
<p>New vault management commands:</p>
<ul class="simple">
<li><p>Listing all accessible service and user vaults.</p></li>
<li><p>Changing vault type.</p></li>
<li><p>Changing vault password.</p></li>
<li><p>Changing vault keys.</p></li>
</ul>
<p>New access control list:</p>
<ul class="simple">
<li><p>A container owner can create and remove sub-containers and vaults in
the container, and manage the members and owners of the container,
but it cannot remove the container itself.</p></li>
<li><p>A container member can list sub-containers and vaults in the
container.</p></li>
<li><p>An escrow officer can recover secrets and reset the vault password.</p></li>
</ul>
</section>
<section id="vault-management">
<span id="id1"></span><h1>Vault Management<a class="headerlink" href="#vault-management" title="Permalink to this heading">¶</a></h1>
<section id="listing-accessible-vaults">
<span id="id2"></span><h2>Listing accessible vaults<a class="headerlink" href="#listing-accessible-vaults" title="Permalink to this heading">¶</a></h2>
<p>A user can search the vaults that it owns or it’s a member of using the
following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find [OPTIONS]
</pre></div>
</div>
<p>By default the command will list the vaults in the private container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find
---------------
1 entries found
---------------
  Vault name: PrivateVault
  User name: testuser
  Type: standard
----------------------------
Number of entries returned 1
----------------------------
</pre></div>
</div>
<p>To find all service vaults, specify –services:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find --services
---------------
1 entries found
---------------
  Vault name: test
  Service name: HTTP/server.example.com
  Type: standard
----------------------------
Number of entries returned 1
----------------------------
</pre></div>
</div>
<p>To find service vaults belonging to a specific service, specify
–service :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find --service HTTP/server.example.com
---------------
1 entries found
---------------
  Vault name: test
  Service name: HTTP/server.example.com
  Type: standard
----------------------------
Number of entries returned 1
----------------------------
</pre></div>
</div>
<p>To find shared vaults, specify -shared:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find --shared
---------------
1 entries found
---------------
  Vault name: test
  Shared: True
  Type: standard
----------------------------
Number of entries returned 1
----------------------------
</pre></div>
</div>
<p>To find all user vaults, specify –users:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find --users
---------------
1 entries found
---------------
  Vault name: test
  User name: testuser
  Type: standard
----------------------------
Number of entries returned 1
----------------------------
</pre></div>
</div>
<p>To find user vaults, specify –user :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-find --user testuser
---------------
1 entries found
---------------
  Vault name: test
  User name: testuser
  Type: standard
----------------------------
Number of entries returned 1
----------------------------
</pre></div>
</div>
</section>
<section id="changing-vault-type">
<span id="id3"></span><h2>Changing vault type<a class="headerlink" href="#changing-vault-type" title="Permalink to this heading">¶</a></h2>
<p>An owner can change the vault type using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod &lt;name&gt; --type &lt;new type&gt; [OPTIONS]
</pre></div>
</div>
<p>To change vault type, the old encryption parameter need to be specified:</p>
<ul class="simple">
<li><p>standard: nothing</p></li>
<li><p>symmetric: password (–old-password or –old-password-file)</p></li>
<li><p>asymmetric: private key (–private-key-file)</p></li>
</ul>
<p>and the new encryption parameter need to be specified:</p>
<ul class="simple">
<li><p>standard: nothing</p></li>
<li><p>symmetric: password (–new-password or –new-password-file)</p></li>
<li><p>asymmetric: public key (–public-key-file)</p></li>
</ul>
<p>If the passwords is not specified, they will be asked interactively.</p>
<p>To change a standard vault into an symmetric vault the new password must
be specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-show test
  Vault name: test
  Type: standard

$ ipa vault-mod test --type symmetric
New password: ********
Verify password: ********
---------------------
Modified vault &quot;test&quot;
---------------------
  Vault name: test
  Type: symmetric
</pre></div>
</div>
<p>To change a symmetric vault into an asymmetric vault the old password
and the new public key must be specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod test --type asymmetric --public-key-file public.pem
Password: ********
---------------------
Modified vault &quot;test&quot;
---------------------
  Vault name: test
  Type: asymmetric
</pre></div>
</div>
<p>To convert an asymmetric vault into a standard vault the old private key
must be specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod test --type standard --private-key-file private.pem
---------------------
Modified vault &quot;test&quot;
---------------------
  Vault name: test
  Type: standard
</pre></div>
</div>
</section>
<section id="changing-vault-password">
<span id="id4"></span><h2>Changing vault password<a class="headerlink" href="#changing-vault-password" title="Permalink to this heading">¶</a></h2>
<p>An owner can change the password of a symmetric vault using the
following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod &lt;name&gt; [OPTIONS]
</pre></div>
</div>
<p>To change the password interactively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod test --change-password
Password: ********
New password: ********
Verify new password: ********
---------------------
Modified vault &quot;test&quot;
---------------------
  Vault name: test
  Type: symmetric
</pre></div>
</div>
<p>To change the password silently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod test --old-password-file &lt;old password file&gt; --new-password-file &lt;new password file&gt;
---------------------
Modified vault &quot;test&quot;
---------------------
  Vault name: test
  Type: symmetric
</pre></div>
</div>
</section>
<section id="changing-vault-keys">
<span id="id5"></span><h2>Changing vault keys<a class="headerlink" href="#changing-vault-keys" title="Permalink to this heading">¶</a></h2>
<p>An owner can change the keys of an asymmetric vault using the following
command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod &lt;name&gt; [OPTIONS]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-mod test --private-key-file private.pem --public-key-file new-public.pem
---------------------
Modified vault &quot;test&quot;
---------------------
</pre></div>
</div>
</section>
</section>
<section id="access-control">
<span id="id6"></span><h1>Access Control<a class="headerlink" href="#access-control" title="Permalink to this heading">¶</a></h1>
<p>In Vault 1.1 a service can be added as a vault owner or members.</p>
<section id="adding-vault-member">
<span id="id7"></span><h2>Adding vault member<a class="headerlink" href="#adding-vault-member" title="Permalink to this heading">¶</a></h2>
<p>A vault owner can add members to the vault with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-add-member &lt;name&gt; [--users &lt;list of users&gt;] [--groups &lt;list of groups&gt;] [--services &lt;list of services&gt;]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-add-member MyVault --users testmember
---------------------------------
Added members to &quot;MyVault &quot; vault
---------------------------------
</pre></div>
</div>
</section>
<section id="removing-vault-member">
<span id="id8"></span><h2>Removing vault member<a class="headerlink" href="#removing-vault-member" title="Permalink to this heading">¶</a></h2>
<p>A vault owner can remove a member from the vault with the following
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-remove-member &lt;name&gt; [--users &lt;list of users&gt;] [--groups &lt;list of groups&gt;] [--services &lt;list of services&gt;]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-remove-member MyVault --users testmember
-------------------------------------
Removed members from &quot;MyVault &quot; vault
-------------------------------------
</pre></div>
</div>
</section>
<section id="adding-vault-owner">
<span id="id9"></span><h2>Adding vault owner<a class="headerlink" href="#adding-vault-owner" title="Permalink to this heading">¶</a></h2>
<p>An owner can add another owner to the vault with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-add-owner &lt;vault ID&gt; [--users &lt;list of users&gt;] [--groups &lt;list of groups&gt;] [--services &lt;list of services&gt;]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-add-owner MyVault --users testowner
----------------------------------
Added owners from &quot;MyVault &quot; vault
----------------------------------
</pre></div>
</div>
</section>
<section id="removing-vault-owner">
<span id="id10"></span><h2>Removing vault owner<a class="headerlink" href="#removing-vault-owner" title="Permalink to this heading">¶</a></h2>
<p>An owner can remove another owner from the vault with the following
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-remove-owner &lt;name&gt; [--users &lt;list of users&gt;] [--groups &lt;list of groups&gt;] [--services &lt;list of services&gt;]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ipa vault-remove-owner MyVault --users testowner
------------------------------------
Removed owners from &quot;MyVault &quot; vault
------------------------------------
</pre></div>
</div>
</section>
<section id="managing-vault-containers">
<span id="id11"></span><h2>Managing vault containers<a class="headerlink" href="#managing-vault-containers" title="Permalink to this heading">¶</a></h2>
<p>Works in the same way as <code class="docutils literal notranslate"><span class="pre">vault-show</span></code>, <code class="docutils literal notranslate"><span class="pre">vault-del</span></code>,
<code class="docutils literal notranslate"><span class="pre">vault-add-owner</span></code> and <code class="docutils literal notranslate"><span class="pre">vault-remove-owner</span></code> commands. Vault container
contains vault. There are three types: shared, per-user, per-service.
Per-user and per-service container is created with a first user/service
vault.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vaultcontainer</span><span class="o">-</span><span class="n">show</span> <span class="p">[</span><span class="o">--</span><span class="n">service</span> <span class="o">&lt;</span><span class="n">service</span><span class="o">&gt;|--</span><span class="n">user</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;|--</span><span class="n">shared</span> <span class="p">]</span>
<span class="n">vaultcontainer</span><span class="o">-</span><span class="k">del</span> <span class="p">[</span><span class="o">--</span><span class="n">service</span> <span class="o">&lt;</span><span class="n">service</span><span class="o">&gt;|--</span><span class="n">user</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;|--</span><span class="n">shared</span> <span class="p">]</span>
<span class="n">vaultcontainer</span><span class="o">-</span><span class="n">add</span><span class="o">-</span><span class="n">owner</span>
        <span class="p">[</span><span class="o">--</span><span class="n">service</span> <span class="o">&lt;</span><span class="n">service</span><span class="o">&gt;|--</span><span class="n">user</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;|--</span><span class="n">shared</span> <span class="p">]</span>
        <span class="p">[</span><span class="o">--</span><span class="n">users</span> <span class="o">&lt;</span><span class="n">users</span><span class="o">&gt;</span><span class="p">]</span>  <span class="p">[</span><span class="o">--</span><span class="n">groups</span> <span class="o">&lt;</span><span class="n">groups</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">services</span> <span class="o">&lt;</span><span class="n">services</span><span class="o">&gt;</span><span class="p">]</span>
<span class="n">vaultcontainer</span><span class="o">-</span><span class="n">remove</span><span class="o">-</span><span class="n">owner</span>
        <span class="p">[</span><span class="o">--</span><span class="n">service</span> <span class="o">&lt;</span><span class="n">service</span><span class="o">&gt;|--</span><span class="n">user</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;|--</span><span class="n">shared</span> <span class="p">]</span>
        <span class="p">[</span><span class="o">--</span><span class="n">users</span> <span class="o">&lt;</span><span class="n">users</span><span class="o">&gt;</span><span class="p">]</span>  <span class="p">[</span><span class="o">--</span><span class="n">groups</span> <span class="o">&lt;</span><span class="n">groups</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">services</span> <span class="o">&lt;</span><span class="n">services</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="reworked-permissions">
<span id="id12"></span><h2>Reworked permissions<a class="headerlink" href="#reworked-permissions" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Added new “Vault administrators” privilege. Vault administrators have
unrestricted access to vaults and vault containers, including the
power to add/remove owners of vaults and vault containers.</p></li>
<li><p>Remove the ability of vault owners to add/remove other vault owners.
If vault owner needs to be changed, vault administrator has to do it.
Note that vault owners will still have the ability to add/remove
vault members.</p></li>
<li><p>When adding new vault container, set owner to the current user. If
vault container owner needs to be changed, vault administrator has to
do it.</p></li>
<li><p>Allowed adding of vaults and vault containers only if the owner is
set to the current user.</p></li>
</ul>
</section>
</section>
<section id="status">
<h1>Status<a class="headerlink" href="#status" title="Permalink to this heading">¶</a></h1>
<p>Completed changes:</p>
<ul class="simple">
<li><p>Skip tests if KRA not available
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=8eb26e9230e43eb2683778b8d667c6c7e632ec36">pushed</a>).</p></li>
<li><p>Validate vault’s file parameters
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=8e28ddd8fab40e985756729f23e8f352d2dab071">pushed</a>).</p></li>
<li><p>Fixed missing KRA agent cert on replica
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=c8882f7d1c98a795195e7bd2e48323ce95edc858">pushed</a>).</p></li>
<li><p>Validate mutually exclusive options in vault-add
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=7d7ffb62526595433412633c05af5af7909124c8">pushed</a>).</p></li>
<li><p>Validate public key in client
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=e4dff25838f7a2342779851bd68460080d77683b">pushed</a>).</p></li>
<li><p>Add CLI param and ACL for vault service operations
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=0dd95a19ee87a04836f12ad4c1194ad31ac22b93">pushed</a>).</p></li>
<li><p>Allow overriding member param label in LDAPModMember
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=d2da0d89d194f198728b858800dfec447c5d9595">pushed</a>).</p></li>
<li><p>Fix param labels in output of vault owner commands
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=d9e9e5088fe3e093e3291a5e8877e8651645fc61">pushed</a>).</p></li>
<li><p>Fixed vault container ownership
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=419754b1c11139435ae5b5082a51026da0d5e730">pushed</a>).</p></li>
<li><p>Normalize service principal in service vault operations
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=76ab7d9bae1a1381af9e7ed51297b00823cce857">pushed</a>).</p></li>
<li><p>Validate vault type
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=6941f4eec70456c542fb565405eed02cceb54e10">pushed</a>).</p></li>
<li><p>Fix vault-find with criteria
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=29cee7a4bc5a6d2506e7937c982339274fa0edb4">pushed</a>).</p></li>
<li><p>Add container information to vault command results
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=01dd951ddc0181b559eb3dd5ff0336c81e245628">pushed</a>).</p></li>
<li><p>Add flag to list all service and user vaults
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=0abaf195dc3b0920d2439dd4ec6df61e0aadc4f9">pushed</a>).</p></li>
<li><p>Add support for changing vault encryption
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=e46d9236d19f714b67fdf2865f19146c3016f46d">pushed</a>).</p></li>
<li><p>Change default vault type to symmetric
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=19dd2ed758210e859a5b0085de558cf13ba09104">pushed</a>).</p></li>
<li><p>Fix vault tests after default type change
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=9b0a01930bcefda1f37d7de147fed0856c28296f">pushed</a>).</p></li>
<li><p>Limit size of data stored in vault
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=02ab34c60b5e624ef0653a473316633a5618b07c">pushed</a>).</p></li>
<li><p>Using LDAPI to setup CA and KRA agents
(<a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=72cfcfa0bd1e867537fcc788512e5fca20708b83">pushed</a>).</p></li>
</ul>
</section>
<section id="test-plan">
<h1>Test Plan<a class="headerlink" href="#test-plan" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="http://www.freeipa.org/page/V4/Password_Vault/Test_Plan">http://www.freeipa.org/page/V4/Password_Vault/Test_Plan</a></p>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="V4/Password_Vault">Password Vault</a></p></li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V4/Password_Vault_1.1.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>