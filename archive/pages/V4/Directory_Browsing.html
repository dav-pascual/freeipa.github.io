<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Distribution_of_CA_certificates_to_clients.html" />
    <link rel="prev" title="Overview" href="Diagnostics_Tool.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>The IPA Web UI needs to provide a way to browse the entire content of
IPA directory (see <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/981">ticket
#981</a>). The current
mechanism has some issues:</p>
<ul class="simple">
<li><p>The UI doesn’t show the entire directory. Due to DS restrictions on
plain LDAP search, currently the UI will only show the first 100
entries. Simply increasing or removing the limit would be impractical
because the UI may have to handle a large amount of data and also it
might degrade server performance.</p></li>
<li><p>The UI doesn’t provide a way to sort the entries. The entries needs
to be sorted based on the entire directory, not based on the entries
currently displayed in the UI.</p></li>
</ul>
<p>There are several options to address these issues:</p>
<ol class="arabic simple">
<li><p>Using Simple Paged Results to retrieve entries</p></li>
<li><p>Using Simple Paged Results to retrieve primary keys</p></li>
<li><p>Virtual List View</p></li>
<li><p>Hybrid solution</p></li>
</ol>
</section>
<section id="option-1-using-simple-paged-results-to-retrieve-entries">
<span id="id1"></span><h1>Option #1: Using Simple Paged Results to retrieve entries<a class="headerlink" href="#option-1-using-simple-paged-results-to-retrieve-entries" title="Permalink to this heading">¶</a></h1>
<p>Simple Paged Results allows the UI to retrieve all entries in multiple
pages. It also supports server-side sorting. The problem is that the
pages are returned sequentially, so the UI will only able to provide a
‘Next’ button. It will not be able to go to a previous or specific page
without re-searching from the beginning. This option also requires the
server to maintain an open connection to the DS while the entries are
being retrieved (see <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/215">ticket
#215</a>).</p>
<p>This is how it will work:</p>
<ol class="arabic simple">
<li><p>The admin opens the first page of the Users list page in the UI.</p></li>
<li><p>The UI issues ipa user-find –offset=0 –count=100
–orderby=uid,cn,email.</p></li>
<li><p>IPA server creates a session and uses simple paged results to
retrieve the first 100 from the DS.</p></li>
<li><p>IPA server returns the results to the UI but it keeps the DS
connection open.</p></li>
<li><p>The UI shows the results of the first page.</p></li>
<li><p>The admin clicks Next.</p></li>
<li><p>The UI issues ipa user-find –offset=100 –count=100.</p></li>
<li><p>IPA server users the same connection to retrieve the next 100 users.</p></li>
<li><p>The UI shows the results of the second page.</p></li>
</ol>
</section>
<section id="option-2-using-simple-paged-results-to-retrieve-primary-keys">
<span id="id2"></span><h1>Option #2: Using Simple Paged Results to retrieve primary keys<a class="headerlink" href="#option-2-using-simple-paged-results-to-retrieve-primary-keys" title="Permalink to this heading">¶</a></h1>
<p>The UI could also use Simple Paged Results to retrieve all primary keys
(see <a class="reference external" href="https://fedorahosted.org/freeipa/ticket/1262">ticket #1262</a>).
Since it has the full list, the UI can go to any page directly. The UI
can then retrieve the additional data (e.g. givenName, sn) for the
entries that are going to be displayed in the current page. This option
does not require server session.</p>
<p>This is how it will work:</p>
<ol class="arabic simple">
<li><p>The admin opens the first page of the Users list page in the UI.</p></li>
<li><p>The UI issues ipa user-find –primary-keys –orderby=uid,cn,email.</p></li>
<li><p>The server uses simple paged results to retrieve all primary keys
from the DS.</p></li>
<li><p>The UI constructs a batch command to retrieve the attributes of the
first 100 users. The batch command consists of ipa user-show
operations.</p></li>
<li><p>The server executes the batch command and return the results to the
UI.</p></li>
<li><p>The UI shows the results of the first page.</p></li>
<li><p>The admin opens a different page (it doesn’t have to be sequential).</p></li>
<li><p>The UI calculates the offset, then constructs a batch command to
retrieve the attributes of the users in that page.</p></li>
<li><p>The server executes the batch command and return the results to the
UI.</p></li>
<li><p>The UI shows the results of that page.</p></li>
</ol>
<p>A complete list of primary keys will be smaller than a complete list of
entries with the attributes. However, for a large directory it might
still be a problem.</p>
</section>
<section id="option-3-virtual-list-view-vlv">
<span id="id3"></span><h1>Option #3: Virtual List View (VLV)<a class="headerlink" href="#option-3-virtual-list-view-vlv" title="Permalink to this heading">¶</a></h1>
<p>VLV allows IPA server to retrieve any page of the search result
directly. The UI will only need to send the offset and the size for the
current page. The problem is that the VLV index has to be created ahead
of time and it has a fixed base, scope, filter, and sort order. Only
search requests that match this configuration will benefit from VLV.
This option does not require server session.</p>
<p>This is how it will work:</p>
<ol class="arabic simple">
<li><p>The admin opens the first page of the Users list page in the UI.</p></li>
<li><p>The UI issues ipa user-find –offset=0 –count=100
–orderby=uid,cn,email.</p></li>
<li><p>IPA server uses VLV to retrieve the users from the DS based on the
requested offset and count.</p></li>
<li><p>IPA server returns the results to the UI.</p></li>
<li><p>The UI shows the results of the first page.</p></li>
<li><p>The admin opens a different page (it doesn’t have to be sequential).</p></li>
<li><p>The UI calculates the offset and issues ipa user-find command.</p></li>
<li><p>IPA server uses VLV to retrieve the users from the DS based on the
requested offset and count.</p></li>
<li><p>IPA server returns the results to the UI.</p></li>
<li><p>The UI shows the results of that page.</p></li>
</ol>
</section>
<section id="option-4-hybrid-solution">
<span id="id4"></span><h1>Option #4: Hybrid solution<a class="headerlink" href="#option-4-hybrid-solution" title="Permalink to this heading">¶</a></h1>
<p>The DS can prepare a few standard VLV indexes, for example “Users sorted
by UID”, “Users sorted by email”. The UI can use them to handle the most
common use cases: browsing without filter and sorted by one attribute.</p>
<p>For less common use cases, the UI can use one of the earlier solutions
using Simple Paged Results.</p>
<p>When the admin opens the list page, the UI determines which type of
operation it’s going to execute.</p>
</section>
<section id="configuring-vlv">
<span id="id5"></span><h1>Configuring VLV<a class="headerlink" href="#configuring-vlv" title="Permalink to this heading">¶</a></h1>
<p>Configure DS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ldapadd</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">D</span> <span class="s2">&quot;cn=Directory Manager&quot;</span> <span class="o">-</span><span class="n">w</span> <span class="n">Secret123</span> <span class="o">&lt;&lt;</span> <span class="n">EOF</span>
<span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">Users</span> <span class="n">cn</span><span class="o">=</span><span class="n">users</span> <span class="n">cn</span><span class="o">=</span><span class="n">accounts</span> <span class="n">dc</span><span class="o">=</span><span class="n">example</span> <span class="n">dc</span><span class="o">=</span><span class="n">com</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">userRoot</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">ldbm</span> <span class="n">database</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">plugins</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">config</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">vlvSearch</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">Users</span> <span class="n">cn</span><span class="o">=</span><span class="n">users</span> <span class="n">cn</span><span class="o">=</span><span class="n">accounts</span> <span class="n">dc</span><span class="o">=</span><span class="n">example</span> <span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">vlvBase</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">users</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">accounts</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">vlvScope</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">vlvFilter</span><span class="p">:</span> <span class="p">(</span><span class="n">objectclass</span><span class="o">=*</span><span class="p">)</span>

<span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">by</span> <span class="n">UID</span> <span class="n">cn</span><span class="o">=</span><span class="n">users</span> <span class="n">cn</span><span class="o">=</span><span class="n">accounts</span> <span class="n">dc</span><span class="o">=</span><span class="n">example</span> <span class="n">dc</span><span class="o">=</span><span class="n">com</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">Users</span> <span class="n">cn</span><span class="o">=</span><span class="n">users</span> <span class="n">cn</span><span class="o">=</span><span class="n">accounts</span> <span class="n">dc</span><span class="o">=</span><span class="n">example</span> <span class="n">dc</span><span class="o">=</span><span class="n">com</span><span class="p">,</span>
  <span class="n">cn</span><span class="o">=</span><span class="n">userRoot</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">ldbm</span> <span class="n">database</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">plugins</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">config</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">vlvIndex</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">by</span> <span class="n">UID</span> <span class="n">cn</span><span class="o">=</span><span class="n">users</span> <span class="n">cn</span><span class="o">=</span><span class="n">accounts</span> <span class="n">dc</span><span class="o">=</span><span class="n">example</span> <span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">vlvSort</span><span class="p">:</span> <span class="n">uid</span> <span class="n">givenName</span> <span class="n">sn</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>Stop DS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="n">dirsrv</span> <span class="n">stop</span> <span class="n">EXAMPLE</span><span class="o">-</span><span class="n">COM</span>
</pre></div>
</div>
<p>Generate indexes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dirsrv</span><span class="o">/</span><span class="n">scripts</span><span class="o">-</span><span class="n">EXAMPLE</span><span class="o">-</span><span class="n">COM</span><span class="o">/</span><span class="n">vlvindex</span> <span class="o">-</span><span class="n">n</span> <span class="n">userRoot</span> \
<span class="o">-</span><span class="n">T</span> <span class="s2">&quot;by UID cn=users cn=accounts dc=example dc=com&quot;</span>
</pre></div>
</div>
<p>Start DS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="n">dirsrv</span> <span class="n">start</span> <span class="n">EXAMPLE</span><span class="o">-</span><span class="n">COM</span>
</pre></div>
</div>
</section>
<section id="using-vlv">
<span id="id6"></span><h1>Using VLV<a class="headerlink" href="#using-vlv" title="Permalink to this heading">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ldapsearch -x -D &quot;cn=Directory Manager&quot; -w Secret123 -b &quot;cn=users,cn=accounts,dc=example,dc=com&quot; -s one \
-E \!vlv=0/100/1/0 -E \!sss=uid/givenName/sn \
&quot;(objectclass=*)&quot; dn givenName sn
</pre></div>
</div>
</section>
<section id="using-simple-paged-results">
<span id="id7"></span><h1>Using Simple Paged Results<a class="headerlink" href="#using-simple-paged-results" title="Permalink to this heading">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ldapsearch -x -D &quot;cn=Directory Manager&quot; -w Secret123 -b &quot;cn=users,cn=accounts,dc=example,dc=com&quot; -s one \
-E \!pr=100 -E \!sss=uid/givenName/sn \
&quot;(objectclass=*)&quot; dn givenName sn
</pre></div>
</div>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="http://directory.fedoraproject.org/wiki/Simple_Paged_Results_Design">Simple Paged
Results</a></p></li>
<li><p><a class="reference external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Directory_Server/8.2/html/Administration_Guide/Creating_Indexes-Creating_VLV_Indexes.html">Creating Browsing (VLV)
Indexes</a></p></li>
<li><p><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-ldapext-ldapv3-vlv-09">LDAP Extensions for Scrolling View Browsing of Search
Results</a></p></li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V4/Directory_Browsing.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>