<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Anonymous_and_All_permissions.html" />
    <link rel="prev" title="Overview" href="API_Compatiblity.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>Allow Active Directory users to use FreeIPA command line interface (CLI)
to manage FreeIPA resources</p>
</section>
<section id="use-cases">
<h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h1>
<p>A forest trust is established between FreeIPA and Active Directory, most
of the users and groups are defined in Active Directory. Allow Active
Directory users to gain access to IPA CLI and manage resources defined
in FreeIPA with the help of IPA CLI.</p>
</section>
<section id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h1>
<p>FreeIPA management framework authenticates users with Kerberos or user
name/password pair. For the latter case it obtains a ticket using the
user name and password and further uses Kerberos authentication against
other FreeIPA resources. Primary resource accessed with Kerberos
credentials by FreeIPA management framework is LDAP server. Kerberos
credentials aren’t forwarded to FreeIPA management framework; instead,
it uses Kerberos S4U2Proxy mechanism to request Kerberos ticket to LDAP
server on behalf of the user.</p>
<ul class="simple">
<li><p>FreeIPA management framework uses Kerberos credentials to
authenticate to LDAP server.</p></li>
<li><p>FreeIPA LDAP server uses SASL mapping configuration to translate
successfully authenticated Kerberos principal to an object in LDAP</p></li>
<li><p>Object in LDAP that corresponds to the Kerberos principal as result
of SASL mapping process is then subjected to LDAP ACIs when
identifying actual access rights to specific attributes of LDAP
objects accessed.</p></li>
</ul>
<p>Thus, in order to allow Active Directory users to authenticate to
FreeIPA framework and to FreeIPA LDAP server, one needs to make sure
Active Directory users are mapped to *some* LDAP objects that can be
used to define access in LDAP ACIs.</p>
<p>FreeIPA provides a mechanism called *ID Overrides* to associate
certain POSIX attributes with Active Directory users. ID override for
the user is a normal LDAP object which can be used to map a Kerberos
identity of an Active Directory user to itself. This LDAP object then
can be added as a member to other FreeIPA groups that define permissions
and roles in the FreeIPA framework.</p>
</section>
<section id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">¶</a></h1>
<p>FreeIPA LDAP server supports multiple SASL maps. Each map is supposed to
produce a unique match between SASL identity and an LDAP object. If
there is a match, a matched LDAP object’s DN is used as a resulted DN of
LDAP BIND operation.</p>
<p>FreeIPA ID Views support multiple views for overriding Active Directory
users and groups. Since a unique match is required, a ‘Default Trust
View’ ID view is used to provide a mapping. This is implemented with a
SASL mapping introduced in <a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/commit/?id=b506fd178edbf1553ca581c44ac6697f88ead125">this git
commit</a>.
SASL mapping is not replicated because it is part of <strong>cn=config</strong> tree
in LDAP, thus every single FreeIPA master needs to be updated in order
to enable access by Active Directory users over LDAP.</p>
<p>ID override for an Active Directory user in ‘Default Trust View’ can be
added to any LDAP group to allow it to be a member of that group.
However, FreeIPA includes a special plugin, called “Member Of plugin”
that propagates information about membership back to the LDAP object
which became a member of a group in LDAP. In order to do so, object
classes associated with the LDAP object must allow ‘memberof’ attribute.
If ‘memberof’ attribute is not allowed, the operation to add ID override
as a member of any LDAP group in FreeIPA LDAP server will fail. Thus, ID
override entry needs to allow ‘memberof’ attribute.</p>
<p>An easiest way to allow ‘memberof’ attribute is to allow it as part of
ipaUserOverride class:</p>
<p><code class="docutils literal notranslate"><span class="pre">objectClasses: (2.16.840.1.113730.3.8.12.31 NAME 'ipaUserOverride' DESC 'Override for User Attributes' SUP ipaOverrideAnchor STRUCTURAL MAY ( uid $ uidNumber $ gidNumber $ homeDirectory $ loginShell $ gecos $ ipaOriginalUid $ userCertificate $ memberOf) X-ORIGIN 'IPA v4' )</span></code></p>
<p>A change like this requires schema update.</p>
<p>Finally, <strong>ipa group-add-member</strong> command should be extended to allow
specifying Active Directory users in <strong>–users</strong> option using fully
qualified user name syntax. Following logic should be used as soon as
‘&#64;’ character is detected in <strong>–users</strong> option value:</p>
<ul class="simple">
<li><p>try to resolve the user to SID</p></li>
<li><p>if succeeded, see if ID override for this user exists in Default
trust view</p></li>
<li><p>if no ID override exist, add it to Default trust view (no attributes
to override is just fine)</p></li>
<li><p>if succeeded, add DN of the override to the group membership list</p></li>
</ul>
</section>
<section id="feature-management">
<h1>Feature Management<a class="headerlink" href="#feature-management" title="Permalink to this heading">¶</a></h1>
<section id="ui">
<h2>UI<a class="headerlink" href="#ui" title="Permalink to this heading">¶</a></h2>
<p>Currently the feature is aimed for use in CLI in the first stage.</p>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Permalink to this heading">¶</a></h2>
<p>Overview of the CLI commands. The only change is to modify existing
group management commands to allow specifying trusted domain users
through fully qualified names:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Options</p></th>
<th class="head"><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>group-add-member</p></td>
<td><p>–users=adm
<a class="reference external" href="mailto:inistrator&#37;&#52;&#48;ad&#46;domain">inistrator<span>&#64;</span>ad<span>&#46;</span>domain</a></p></td>
<td><p>Add trusted domain
user to a group. If
ID override for this
user is missing, add
it to ‘Default Trust
View’</p></td>
</tr>
<tr class="row-odd"><td><p>group-remove-member</p></td>
<td><p>–users=adm
<a class="reference external" href="mailto:inistrator&#37;&#52;&#48;ad&#46;domain">inistrator<span>&#64;</span>ad<span>&#46;</span>domain</a></p></td>
<td><p>Remove trusted
domain user to from
a group.</p></td>
</tr>
<tr class="row-even"><td><p>group-show</p></td>
<td></td>
<td><p>Show members that
are trusted domain
users</p></td>
</tr>
</tbody>
</table>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
</section>
</section>
<section id="upgrade">
<h1>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this heading">¶</a></h1>
<p>Any impact on upgrades? Remove this section if not applicable.</p>
</section>
<section id="how-to-use">
<h1>How to Use<a class="headerlink" href="#how-to-use" title="Permalink to this heading">¶</a></h1>
<p>Easy to follow instructions how to use the new feature according to the
<a class="reference external" href="#Use_Cases">use cases</a> described above. FreeIPA user needs to be
able to follow the steps and demonstrate the new features.</p>
<p>The chapter may be divided in sub-sections per <a class="reference external" href="#Use_Cases">Use
Case</a>.</p>
</section>
<section id="test-plan">
<h1>Test Plan<a class="headerlink" href="#test-plan" title="Permalink to this heading">¶</a></h1>
<p>Test scenarios that will be transformed to test cases for FreeIPA
<a class="reference external" href="V3/Integration_testing">Continuous Integration</a> during
implementation or review phase. This can be also link to <a class="reference external" href="https://git.fedorahosted.org/cgit/freeipa.git/">source in
cgit</a> with the test,
if appropriate.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V4/Allow_AD_users_to_manage_FreeIPA.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>