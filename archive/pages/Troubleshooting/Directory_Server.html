<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Replication issues &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Server Installation" href="Installation.html" />
    <link rel="prev" title="Getting logs" href="DNS.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>This page contains troubleshooting advice for <strong>directory server</strong>
issues. For other issues, refer to the index at
<a class="reference external" href="Troubleshooting">Troubleshooting</a>.</p>
<section id="replication-issues">
<span id="id1"></span><h1>Replication issues<a class="headerlink" href="#replication-issues" title="Permalink to this heading">¶</a></h1>
<ul>
<li><p>If changes done on one FreeIPA master are not replicated to another
master, always verify <code class="docutils literal notranslate"><span class="pre">errors</span></code> log on both master and replica. It
most often contains exact error what is wrong</p></li>
<li><p>Make sure that there are no <a class="reference external" href="Troubleshooting#DNS_Issues">DNS
issues</a> and both replicas can resolve
each other’s forward and reverse DNS records or that <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code>
does not contain address of the remote DS with it’s short them being
the primary (first) name.</p></li>
<li><p>Make sure that the system time difference on the FreeIPA masters is
not greater than 5 minutes</p></li>
<li><p>In case of Kerberos issues in the log, verify that the DS keytab is
correct and can be used to query other master:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">kinit</span> <span class="pre">-kt</span> <span class="pre">/etc/dirsrv/ds.keytab</span> <span class="pre">ldap/`hostname`</span></code>
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">klist</span></code>
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">ldapsearch</span> <span class="pre">-Y</span> <span class="pre">GSSAPI</span> <span class="pre">-h</span> <span class="pre">`hostname</span></code> -b “” -s base`
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">ldapsearch</span> <span class="pre">-Y</span> <span class="pre">GSSAPI</span> <span class="pre">-h</span> <span class="pre">the.other.master.fqdn</span> <span class="pre">-b</span> <span class="pre">&quot;&quot;</span> <span class="pre">-s</span> <span class="pre">base</span></code></p>
</div></blockquote>
</li>
<li><p>Make sure that DS communication is not failing because of wrong
default for SASL communication buffer (<a class="reference external" href="https://fedorahosted.org/freeipa/ticket/4807">FreeIPA ticket with more
information</a>). This
can be detected by seeing following error message in
<code class="docutils literal notranslate"><span class="pre">/var/log/messages</span></code> or
<code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">status</span> <span class="pre">dirsrv&#64;YOUR-INSTANCE.service</span></code> unit log in case of
systemd:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">[01/Dec/2014:12:00:00</span> <span class="pre">+0100]</span> <span class="pre">-</span> <span class="pre">sasl_io_recv</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">decode</span> <span class="pre">packet</span> <span class="pre">for</span> <span class="pre">connection</span> <span class="pre">xxxx</span></code></p>
</div></blockquote>
</li>
</ul>
</section>
<section id="obsolete-ruv-records">
<span id="id2"></span><h1>Obsolete RUV records<a class="headerlink" href="#obsolete-ruv-records" title="Permalink to this heading">¶</a></h1>
<ul>
<li><p>If the FreeIPA infrastructure keep getting obsolete RUV records
(<code class="docutils literal notranslate"><span class="pre">ipa-replica-manage</span> <span class="pre">list-ruv</span></code>) which cannot be removed by
<code class="docutils literal notranslate"><span class="pre">ipa-replica-manage</span> <span class="pre">clean-ruv</span></code> command and for example give status
like
<code class="docutils literal notranslate"><span class="pre">RID</span> <span class="pre">XX</span> <span class="pre">Waiting</span> <span class="pre">to</span> <span class="pre">process</span> <span class="pre">all</span> <span class="pre">the</span> <span class="pre">updates</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">deleted</span> <span class="pre">replica...</span></code>
but never finish, make sure that IPv6 is not disabled on the FreeIPA
replicas (related
<a class="reference external" href="https://www.redhat.com/archives/freeipa-users/2015-September/msg00332.html">freeipa-users</a>
thread)</p></li>
<li><p>Obsolete CA RUV records. FreeIPA &lt; 4.4 doesn’t have
<a class="reference external" href="V4/Manage_replication_topology_4_4#ipa-replica-manage">means</a> to
remove obsolete CA RUVs. They usually manifest in directory server
log as</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">attrlist_replace</span> <span class="o">-</span> <span class="n">attr_replace</span> <span class="p">(</span><span class="n">nsslapd</span><span class="o">-</span><span class="n">referral</span><span class="p">,</span> <span class="n">ldap</span><span class="p">:</span><span class="o">//</span><span class="n">my</span><span class="o">.</span><span class="n">ipa</span><span class="o">.</span><span class="n">test</span><span class="p">:</span><span class="mi">389</span><span class="o">/</span><span class="n">o</span><span class="o">%</span><span class="mi">3</span><span class="n">Dipaca</span><span class="p">)</span> <span class="n">failed</span><span class="o">.</span>
</pre></div>
</div>
<p>recovery is described at <a class="reference external" href="https://www.redhat.com/archives/freeipa-users/2016-May/msg00043.html">FreeIPA users list
post</a></p>
</div></blockquote>
</li>
</ul>
</section>
<section id="performance-tuning">
<span id="id3"></span><h1>Performance tuning<a class="headerlink" href="#performance-tuning" title="Permalink to this heading">¶</a></h1>
<p>See <a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html-single/Linux_Domain_Identity_Authentication_and_Policy_Guide/index.html#Preparing_for_an_IPA_Installation-Hardware_Requirements">hardware
recommendations</a>
and <a class="reference external" href="https://access.redhat.com/documentation/en-us/red_hat_directory_server/11/html/performance_tuning_guide/index">Directory Server 11
tuning</a>.</p>
</section>
<section id="advanced-troubleshooting">
<span id="id4"></span><h1>Advanced Troubleshooting<a class="headerlink" href="#advanced-troubleshooting" title="Permalink to this heading">¶</a></h1>
<p>See <a class="reference external" href="http://www.port389.org/docs/389ds/FAQ/faq.html#troubleshooting">troubleshooting
section</a>
of <a class="reference external" href="http://www.port389.org/">389 Directory Server</a>
<a class="reference external" href="http://www.port389.org/docs/389ds/FAQ/faq.html">FAQ</a> including the
information how to retrieve a core dump and a stacktrace if the
<a class="reference external" href="Directory_Server">Directory Server</a> is crashing.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/Troubleshooting/Directory_Server.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>