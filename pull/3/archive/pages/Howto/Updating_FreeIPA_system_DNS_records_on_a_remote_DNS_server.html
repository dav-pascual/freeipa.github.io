<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Short feature description &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Initial Setup" href="Using_FreeIPA_CA_for_Puppet.html" />
    <link rel="prev" title="&lt;no title&gt;" href="Setting_up_S4U2Proxy_with_FreeIPA.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="short-feature-description">
<span id="id1"></span><h1>Short feature description<a class="headerlink" href="#short-feature-description" title="Permalink to this heading">¶</a></h1>
<p>FreeIPA with integrated DNS updates dynamically its own DNS records
after changes in topology. This can be also executed manually by calling
command <code class="docutils literal notranslate"><span class="pre">ipa</span> <span class="pre">dns-update-system-records</span></code>.</p>
<p>However this is not so simple with external DNS services. For this case
the option <code class="docutils literal notranslate"><span class="pre">--dry-run</span></code> can provide list of required DNS records and
option <code class="docutils literal notranslate"><span class="pre">--out</span> <span class="pre">FILE</span></code> can export data in <em>nsupdate</em> util format. This
can be used directly with <code class="docutils literal notranslate"><span class="pre">nsupdate</span></code> util.</p>
</section>
<section id="supported-in-versions">
<span id="id2"></span><h1>Supported in versions<a class="headerlink" href="#supported-in-versions" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p><strong>4.4+</strong> <code class="docutils literal notranslate"><span class="pre">dns-update-system-records</span></code> command</p></li>
<li><p><strong>4.5+</strong> <code class="docutils literal notranslate"><span class="pre">dns-update-system-records</span></code> with <code class="docutils literal notranslate"><span class="pre">--out</span></code> option</p></li>
</ul>
</section>
<section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h1>
<section id="show-list-of-required-records">
<span id="id3"></span><h2>Show list of required records<a class="headerlink" href="#show-list-of-required-records" title="Permalink to this heading">¶</a></h2>
<p>This can be handy in a case you have hosted external DNS and management
is done via GUI to see records that have to be updated manually.</p>
<p>The list of records can look for example like this:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ ipa dns-update-system-records --dry-run</span></code></div>
<div class="line">`` IPA DNS records:``</div>
<div class="line">``   _kerberos-master._tcp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.``</div>
<div class="line">``   _kerberos-master._udp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.``</div>
<div class="line">``   _kerberos._tcp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.``</div>
<div class="line">``   _kerberos._udp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.``</div>
<div class="line">``   _kerberos.example.com. 86400 IN TXT “EXAMPLE.COM”``</div>
<div class="line">``   _kpasswd._tcp.example.com. 86400 IN SRV 0 100 464 ipa.example.com.``</div>
<div class="line">``   _kpasswd._udp.example.com. 86400 IN SRV 0 100 464 ipa.example.com.``</div>
<div class="line">``   _ldap._tcp.example.com. 86400 IN SRV 0 100 389 ipa.example.com.``</div>
<div class="line">``   _ntp._udp.example.com. 86400 IN SRV 0 100 123 ipa.example.com.``</div>
<div class="line">``   ipa-ca.example.com. 86400 IN A 192.0.2.36``</div>
<div class="line">``   ipa-ca.example.com. 86400 IN AAAA 2001:db8:0:224e:21a:4aff:fe23:1523``</div>
</div>
</section>
<section id="generating-a-file-with-freeipa-dns-data-for-nsupdate-utility">
<span id="id4"></span><h2>Generating a file with FreeIPA DNS data for <em>nsupdate</em> utility<a class="headerlink" href="#generating-a-file-with-freeipa-dns-data-for-nsupdate-utility" title="Permalink to this heading">¶</a></h2>
<p>Option <code class="docutils literal notranslate"><span class="pre">--out</span> <span class="pre">FILE</span></code> will store DNS data in <em>nsupdate</em> format in file
<em>FILE</em>.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ ipa dns-update-system-records --dry-run --out ipa-records.nsupdate</span></code></div>
<div class="line">``  IPA DNS records:``</div>
<div class="line">``   …``</div>
<div class="line"><a href="#id5"><span class="problematic" id="id6">``</span></a>[<a class="reference external" href="mailto:user&#37;&#52;&#48;ipa">user<span>&#64;</span>ipa</a> ~]$ cat ipa-records.nsupdate ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">; IPA DNS records</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update delete _kerberos-master._tcp.example.com. SRV</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update add _kerberos-master._tcp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update delete _kerberos-master._udp.example.com. SRV</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update add _kerberos-master._udp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">.....</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update delete ipa-ca.example.com. AAAA</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update add ipa-ca.example.com. 86400 IN AAAA 2001:db8::0:224e:21a:4aff:fe23:1523</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">send</span></code></div>
</div>
<section id="notes-about-exported-nsupdate-file">
<span id="id7"></span><h3>Notes about exported <em>nsupdate</em> file<a class="headerlink" href="#notes-about-exported-nsupdate-file" title="Permalink to this heading">¶</a></h3>
<p>By default records exported by <code class="docutils literal notranslate"><span class="pre">dns-update-system-records</span></code> relies on
auto-detection of the zone where records should be updated and the
authoritative server of that zone. In majority cases this should just
work. However in non-standard DNS setup or missing zone delegations,
<em>nsupdate</em> may not be able to find the right zone and server. For these
cases the exported file must be amended by following options (at the
beginning of the file):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">server</span></code><em>``servername``</em><code class="docutils literal notranslate"><span class="pre">[</span></code><em>``por``</em><code class="docutils literal notranslate"><span class="pre">t]</span></code> where
<em>servername</em> is an authoritative DNS server where records should be
sent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zone</span></code><em>``zonename``</em> where <em>zonename</em> is zone where FreeIPA
records should be placed</p></li>
</ul>
<p>Example:</p>
<div class="line-block">
<div class="line"><a href="#id8"><span class="problematic" id="id9">``</span></a>[<a class="reference external" href="mailto:user&#37;&#52;&#48;ipa">user<span>&#64;</span>ipa</a> ~]$ cat ipa-records.nsupdate ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">zone example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">server 192.0.2.222</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">; IPA DNS records</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update delete _kerberos-master._tcp.example.com. SRV</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">update add _kerberos-master._tcp.example.com. 86400 IN SRV 0 100 88 ipa.example.com.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">...</span></code></div>
</div>
<p>For more details please see <em>man nsupdate</em>.</p>
</section>
</section>
<section id="using-nsupdate-with-tsig">
<span id="id10"></span><h2>Using <em>nsupdate</em> with TSIG<a class="headerlink" href="#using-nsupdate-with-tsig" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc2845">TSIG</a> mechanism allows to use
nsupdate utility with securely by using a shared key. The DNS server
must be configured and both server and client must have the particular
shared key to allow updates.</p>
<p>Server configuration examples:</p>
<ul class="simple">
<li><p><a class="reference external" href="ftp://ftp.isc.org/www/bind/arm95/Bv9ARM.ch04.html#tsig">BIND</a></p></li>
<li><p><a class="reference external" href="https://doc.powerdns.com/md/authoritative/dnsupdate/#dns-update-how-to-setup-dyndnsrfc2136-with-dhcpd">PowerDNS</a></p></li>
<li><p><a class="reference external" href="https://www.knot-dns.cz/docs/2.x/html/configuration.html#dynamic-updates">Knot DNS
1</a>
+ <a class="reference external" href="https://www.knot-dns.cz/docs/2.x/html/configuration.html#access-control-list-acl">Knot DNS
2</a>
+ <a class="reference external" href="https://www.knot-dns.cz/docs/2.x/html/man_keymgr.html#tsig-commands">Knot DNS
3</a>,</p></li>
</ul>
<p>Run <em>nsupdate</em> with the <code class="docutils literal notranslate"><span class="pre">-k</span> <span class="pre">keyfile</span></code> option:</p>
<p><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ nsupdate -k tsig-key.keyfile ipa-records.nsupdate</span></code></p>
<p>or with <code class="docutils literal notranslate"><span class="pre">-y</span> <span class="pre">algorithm:keyname:secret</span></code> option:</p>
<p><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ nsupdate -y algorithm:keyname:secret ipa-records.nsupdate</span></code></p>
<p>More details about <em>nsupdate</em> with TSIG and how to generate keyfiles can
be found <a class="reference external" href="Howto/DNS_updates_and_zone_transfers_with_TSIG">here</a></p>
</section>
<section id="using-nsupdate-with-gss-tsig">
<span id="id11"></span><h2>Using <em>nsupdate</em> with GSS-TSIG<a class="headerlink" href="#using-nsupdate-with-gss-tsig" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://tools.ietf.org/html/rfc3645">GSS-TSIG</a> mechanism uses
<a class="reference external" href="https://tools.ietf.org/html/rfc2743">GSS-API</a> for getting secret
TSIG key. Details about GSS-API is out of scope of this document, for
simplification we will assume <em>Kerberos V5</em> as used technology for
GSS-API (“kerberized” DNS servers are usually the most used).</p>
<p>Examples of server configuration:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://ddiguru.com/blog/136-how-to-implement-gss-tsig-on-isc-bind">BIND</a></p></li>
<li><p><a class="reference external" href="https://doc.powerdns.com/md/authoritative/gss-tsig/">PowerDNS</a></p></li>
<li><p><a class="reference external" href="https://technet.microsoft.com/en-us/library/cc961412.aspx">Windows
DNS</a></p></li>
</ul>
<p>Run <em>nsupdate</em> with option <code class="docutils literal notranslate"><span class="pre">-g</span></code></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ kinit principal-allowed-to-update-records&#64;REALM</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ nsupdate -g ipa-records.nsupdate</span></code></div>
</div>
</section>
<section id="using-nsupdate-without-authentication">
<span id="id12"></span><h2>Using <em>nsupdate</em> without authentication<a class="headerlink" href="#using-nsupdate-without-authentication" title="Permalink to this heading">¶</a></h2>
<p>Using <em>nsupdate</em> without authentication is discouraged. However if you
really need this, then set up DNS server to allow dynamic updates from
the particular IP address/IP range.</p>
<p>Server configuration examples:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.zytrax.com/books/dns/ch7/xfer.html#allow-update">BIND</a></p></li>
<li><p><a class="reference external" href="https://doc.powerdns.com/md/authoritative/dnsupdate/#allow-dnsupdate-from">PowerDNS</a></p></li>
<li><p><a class="reference external" href="https://www.knot-dns.cz/docs/2.x/html/configuration.html#dynamic-updates">Knot
DNS</a></p></li>
</ul>
<p>Run <em>nsupdate</em> without options:</p>
<p><code class="docutils literal notranslate"><span class="pre">[user&#64;ipa ~]$ nsupdate ipa-records.nsupdate</span></code></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/Howto/Updating_FreeIPA_system_DNS_records_on_a_remote_DNS_server.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>