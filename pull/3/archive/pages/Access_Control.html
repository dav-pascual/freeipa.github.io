<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The problem &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Description" href="Active_Directory_trust_setup.html" />
    <link rel="prev" title="&lt;no title&gt;" href="About_FreeIPA.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="the-problem">
<h1>The problem<a class="headerlink" href="#the-problem" title="Permalink to this heading">¶</a></h1>
<p>Fine-grained access to parts of the DIT</p>
<p>We need to be able to say WHO can do WHAT to WHOM</p>
<section id="writes">
<h2>Writes<a class="headerlink" href="#writes" title="Permalink to this heading">¶</a></h2>
<p>The WHO can be:</p>
<ul class="simple">
<li><p>a user or users</p></li>
<li><p>a group or groups</p></li>
</ul>
<p>The WHAT can be:</p>
<ul class="simple">
<li><p>modify one or more attributes on an entry (ex.)</p>
<ul>
<li><p>reset a password</p></li>
<li><p>modify an address</p></li>
<li><p>add a user to a group</p></li>
</ul>
</li>
<li><p>add a new entry</p></li>
<li><p>remove an existing entry</p></li>
</ul>
<p>The WHOM can be:</p>
<ul class="simple">
<li><p>a user or all users</p></li>
<li><p>a group or groups</p></li>
<li><p>self</p></li>
</ul>
</section>
<section id="reads">
<h2>Reads<a class="headerlink" href="#reads" title="Permalink to this heading">¶</a></h2>
<p>Any user can read any other user or group. This is simply the unix way.
Some attributes such as password will always be protected. This was
extended to services in IPA v1 and will continue in v2 so one can see
what services are available.</p>
<p>We will not by default grant read access to:</p>
<ul class="simple">
<li><p>Machines</p></li>
<li><p>Policy</p></li>
</ul>
</section>
<section id="other-rights">
<h2>Other rights<a class="headerlink" href="#other-rights" title="Permalink to this heading">¶</a></h2>
<p>The interesting rights that 389 DS provides that IPA would use are:
read, write, add, delete, search, and selfwrite.</p>
</section>
<section id="anonymous-access">
<h2>Anonymous Access<a class="headerlink" href="#anonymous-access" title="Permalink to this heading">¶</a></h2>
<p>Currently there is read access to the entire subtree (minus a few
important attributes like userPassword) for anonymous users. In order to
limit access to services, machines, etc. I propose that we modify the
anonymous read access to include just users and groups. Basically just
enough so that nss_ldap will still work with an anonymous bind.</p>
</section>
</section>
<section id="the-solution">
<h1>The Solution<a class="headerlink" href="#the-solution" title="Permalink to this heading">¶</a></h1>
<p>From a high level we will:</p>
<ul class="simple">
<li><p>Create groups (task groups) that are allowed to perform tasks</p></li>
<li><p>Create an ACI that grants permission for a group to perform a
specific task</p></li>
<li><p>Create groups (role groups) that will be be members of task groups,
granting the role group the underlying permission</p></li>
<li><p>Assign users and groups to role groups</p></li>
</ul>
<section id="task-groups-and-acis">
<h2>Task Groups and ACIs<a class="headerlink" href="#task-groups-and-acis" title="Permalink to this heading">¶</a></h2>
<p>For the purposes of this discussion one task == one ACI “group”. These
groups will be stored outside of cn=accounts so they don’t interfere
with standard groups. I propose cn=taskgroup, dc=SUFFIX. The structural
objectclass will be groupOfNames.</p>
<p>1 task == 1 ACI</p>
<p>There may be multiple ACIs for a given high level task but it will be
implemented by combining low level tasks.</p>
<p>Take adding a user as an example. When a user is added we also
automatically add that user to the default IPA group (ipausers). For the
“Add a user” task we will need 3 ACIs:</p>
<ul class="simple">
<li><p>one to allow creating users and one to allow adding a user to a group
(access to the member attribute).</p></li>
<li><p>one to allow writing the member attribute of a group</p></li>
<li><p>allow the a password reset</p></li>
</ul>
<p>A 3rd task group may be created, “Add an IPA User”, that is a member of
these 3 task groups, combining them into a logical task. This will help
limit the total number of ACIs in the system, particularly with
duplication, because a task may be a member of several groups.</p>
<p>The ACIs will be stored in cn=accounts, the same way as in v1.</p>
</section>
<section id="role-groups">
<h2>Role Groups<a class="headerlink" href="#role-groups" title="Permalink to this heading">¶</a></h2>
<p>We will also have role groups. A role is a collection of tasks or other
roles. These will be things like helpdesk, user admin, group admin,
replica admin, etc. These will also be stored outside of the cn=accounts
tree. These groups are for data management only and not for system
management. Perhaps in cn=delegationgroup, dc=SUFFIX. The structural
objectclass will be groupOfNames.</p>
<p>A role here is not to be confused with RBAC or native 389 DS/RHDS roles.
It is simply a term I’m using to designate the permissions of an
administrative group.</p>
<p>Rights are assigned by adding tasks as a member to these role groups. So
a helpdesk user may be able to see users, groups, and systems but only
have write access on user passwords. We would have several ACIs/task
groups to handle this:</p>
<ul class="simple">
<li><p>reset password</p></li>
<li><p>view users</p></li>
<li><p>view groups</p></li>
<li><p>view systems</p></li>
</ul>
<p>An IPA install will include a default set of canned tasks, including
things like:</p>
<ul class="simple">
<li><p>Add/Delete user</p></li>
<li><p>Add/Remove user to group</p></li>
<li><p>View Machines</p></li>
<li><p>Change password</p></li>
<li><p>etc</p></li>
</ul>
<p>Each one of these is a discrete ACI granting the appropriate permission
to a unique group (like add_user group, add user_to_group, etc). The
task group name itself is unimportant, it just needs to be unique and
hopefully meaningful.</p>
<p>We will continue to have the admin user and the admins group. This is
the super-user and group of users that can do whatever they would like
in the IPA world.</p>
</section>
<section id="the-bottom-line">
<h2>The bottom line<a class="headerlink" href="#the-bottom-line" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>An ACI grants permissions to a task group. There is a single ACI for
each task group. One may group ACIs together by adding their task
groups the same group.</p></li>
<li><p>A role is the member of one or more task groups</p></li>
<li><p>A user/group/role is a member of one or more roles</p></li>
</ul>
</section>
<section id="aci-details">
<h2>ACI Details<a class="headerlink" href="#aci-details" title="Permalink to this heading">¶</a></h2>
<p>An ACI is made up 3 major components that we’re interested in:</p>
<ul class="simple">
<li><p>source/bind rule (WHO is being granted access)</p></li>
<li><p>rights (read, write, etc) (WHAT is being granted)</p></li>
<li><p>target (WHO you are granting rights to)</p></li>
</ul>
<section id="source">
<h3>Source<a class="headerlink" href="#source" title="Permalink to this heading">¶</a></h3>
<p>This will always be a Task group.</p>
</section>
<section id="rights">
<h3>Rights<a class="headerlink" href="#rights" title="Permalink to this heading">¶</a></h3>
<p>Will be: read, write, add, delete, search, and/or selfwrite</p>
<p>All ACIs will GRANT access, not deny it.</p>
</section>
<section id="target">
<h3>Target<a class="headerlink" href="#target" title="Permalink to this heading">¶</a></h3>
<p>The target may be a set of attributes, a portion of the subtree a filter
or a combination of these.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h3>
<p>Note that in these examples I’m not using the new location to store the
task groups. You can apply these to a v1 IPA server to see how it works.</p>
<section id="create-a-new-user">
<h4>Create a new user<a class="headerlink" href="#create-a-new-user" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(target=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///uid=</span></code> &lt;<a class="reference external" href="ldap:///uid=">ldap:///uid=</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">*,cn=users,cn=accounts,dc=example,dc=com&quot;)(version</span> <span class="pre">3.0;acl</span> <span class="pre">&quot;add_user&quot;;allow</span> <span class="pre">(add)</span> <span class="pre">groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=add_user,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=add_user,cn=taskgroups,dc=example,dc=com">ldap:///cn=add_user,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
<p>But this isn’t enough. We also add the new user to the default IPA
group. Here is an ACI which allows that, specifically limiting the write
operation to the default group. This would be difficult to keep in sync
in reality but illustrates how tight we can make things.</p>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(targetattr=member)(target=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=ipausers,cn=groups,cn=accounts,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=ipausers,cn=groups,cn=accounts,dc=example,dc=com">ldap:///cn=ipausers,cn=groups,cn=accounts,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;)(version</span> <span class="pre">3.0;acl</span> <span class="pre">&quot;add_user_to_default_group&quot;;allow</span> <span class="pre">(write)</span> <span class="pre">groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=add_user_to_default_group,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=add_user_to_default_group,cn=taskgroups,dc=example,dc=com">ldap:///cn=add_user_to_default_group,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
<p>And still this isn’t enough. We also try to set the password. Rather
than doing this by setting the userPassword attribute we do an LDAP
password change. So we need to grant permission to change passwords as
well (see Reset password).</p>
<p>So now we have 3 task groups to add a user. If we wanted we could create
a 4th task group which combines these as a shortcut. This shows that
good descriptions will be required so that people making delegations can
understand what each task does. So this combined task should be named
something like create_ipa_user.</p>
<p>The task entry for the add_user ACI will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">add_user</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">add_user</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Allowed</span> <span class="n">to</span> <span class="n">add</span> <span class="n">new</span> <span class="n">users</span>
<span class="n">member</span><span class="p">:</span> <span class="n">uid</span><span class="o">=</span><span class="n">tuser</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">users</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">accounts</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
<p>The task entry for create_ipa_user will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">create_ipa_user</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">create_ipa_user</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Allowed</span> <span class="n">to</span> <span class="n">create</span> <span class="n">IPA</span> <span class="n">users</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">add_user</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">add_user_to_default_group</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">change_password</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
</section>
<section id="reset-password">
<h4>Reset password<a class="headerlink" href="#reset-password" title="Permalink to this heading">¶</a></h4>
<p>Crafting some rules may require a fairly detailed knowledge of LDAP and
the IPA implementation, as demonstrated with this long list of
attributes that may be written when resetting a password.</p>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(targetattr</span> <span class="pre">=</span> <span class="pre">&quot;userPassword</span> <span class="pre">||</span> <span class="pre">krbPrincipalKey</span> <span class="pre">||</span> <span class="pre">sambaLMPassword</span> <span class="pre">||</span> <span class="pre">sambaNTPassword</span> <span class="pre">||</span> <span class="pre">passwordHistory&quot;)(version</span> <span class="pre">3.0;</span> <span class="pre">acl</span> <span class="pre">&quot;change_password&quot;;</span> <span class="pre">allow</span> <span class="pre">(write)</span> <span class="pre">groupdn</span> <span class="pre">=</span> <span class="pre">&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=change_password,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=change_password,cn=taskgroups,dc=example,dc=com">ldap:///cn=change_password,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
</section>
<section id="remove-user">
<h4>Remove user<a class="headerlink" href="#remove-user" title="Permalink to this heading">¶</a></h4>
<p>Once the basic structure of the ACIs is found then granting specific
rights becomes easier and easier. This is the same ACI as add_user
simply with a different right. One would also need to be a member of the
“modify group membership” group so that the membership may be modified.</p>
<p><code class="docutils literal notranslate"><span class="pre">aci:</span> <span class="pre">(target=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///uid=</span></code> &lt;<a class="reference external" href="ldap:///uid=">ldap:///uid=</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">*,cn=users,cn=accounts,dc=example,dc=com&quot;)(version</span> <span class="pre">3.0;acl</span> <span class="pre">&quot;delete_user&quot;;allow</span> <span class="pre">(delete)</span> <span class="pre">groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap:///cn=delete_user,cn=taskgroups,dc=example,dc=com</span></code> &lt;<a class="reference external" href="ldap:///cn=delete_user,cn=taskgroups,dc=example,dc=com">ldap:///cn=delete_user,cn=taskgroups,dc=example,dc=com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;)</span></code></p>
</section>
<section id="side-effects">
<h4>Side effects<a class="headerlink" href="#side-effects" title="Permalink to this heading">¶</a></h4>
<p>We may need to add in specific ACIs that prevent the deletion of
specific users and groups. admin comes to mind.</p>
</section>
<section id="roles">
<h4>Roles<a class="headerlink" href="#roles" title="Permalink to this heading">¶</a></h4>
<p>These ACIs will be rolled up into a set of Roles, a set of which will be
pre-defined when IPA is shipped. These roles can then be customized by
IPA administrators to fit the site needs.</p>
<p>Helpdesk</p>
<p>Helpdesk users can typically reset passwords.</p>
<p>So we start with a helpdesk role:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">helpdesk</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">rolegroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">helpdesk</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Helpdesk</span>
<span class="n">member</span><span class="p">:</span> <span class="n">uid</span><span class="o">=</span><span class="n">tuser</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">users</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">accounts</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
<p>And add that role to the task for changing passwords:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dn</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">change_password</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">taskgroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectclass</span><span class="p">:</span> <span class="n">groupofnames</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">create_ipa_user</span>
<span class="n">description</span><span class="p">:</span> <span class="n">Allowed</span> <span class="n">to</span> <span class="n">change</span> <span class="n">passwords</span>
<span class="n">member</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">helpdesk</span><span class="p">,</span><span class="n">cn</span><span class="o">=</span><span class="n">rolegroups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="use-cases">
<span id="use-cases11"></span><h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h2>
<section id="separate-admins-for-separate-containers">
<h3>Separate admins for separate containers<a class="headerlink" href="#separate-admins-for-separate-containers" title="Permalink to this heading">¶</a></h3>
<p>Currently all users are in cn=users,cn=accounts. If we allow users to be
created in another part of the tree (aka another user container) then we
can create per-container admins, granting full access to this container
to that admin.</p>
<p>Alternatively we can grant access based on the value of an attribute in
a record that isn’t part of the DN using <code class="docutils literal notranslate"><span class="pre">targetfilter</span></code> to set the
target based on the value of an attribute:</p>
<p><code class="docutils literal notranslate"><span class="pre">(targetfilter = &quot;(|(ou=accounting)(ou=engineering))&quot;)</span></code></p>
</section>
<section id="limit-self-service-changes-by-attribute">
<h3>Limit self-service changes by attribute<a class="headerlink" href="#limit-self-service-changes-by-attribute" title="Permalink to this heading">¶</a></h3>
<p>Add ability to limit what attributes can be modified on the self-service
page</p>
</section>
<section id="flexibility-in-attributes-that-may-be-delegated">
<h3>Flexibility in attributes that may be delegated<a class="headerlink" href="#flexibility-in-attributes-that-may-be-delegated" title="Permalink to this heading">¶</a></h3>
<p>The list of attributes that one can grant write access to needs to be
configurable</p>
</section>
<section id="delegate-entry-user-group-whatever-creation">
<h3>Delegate entry (user, group, whatever) creation<a class="headerlink" href="#delegate-entry-user-group-whatever-creation" title="Permalink to this heading">¶</a></h3>
<p>In v1 we only delegate attribute writes, not add or delete permissions.
Some granularity can be obtained by granting access only to users
(cn=users), groups (cn=groups), etc. along with attributes.</p>
</section>
</section>
</section>
<section id="additional-ui-capabilities-needed">
<h1>Additional UI Capabilities Needed<a class="headerlink" href="#additional-ui-capabilities-needed" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>Means to select entries by container (if supported)</p></li>
<li><p>Means to select one or more entries (could be users or groups or
both)</p></li>
<li><p>Means to manage list of attributes that may be delegated</p></li>
<li><p>Means to manage add/list/delete delegations</p></li>
</ul>
<section id="delegate-anything">
<h2>Delegate anything<a class="headerlink" href="#delegate-anything" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>add users/groups/systems/other</p></li>
<li><p>delete users/groups/systems/other</p></li>
<li><p>allow arbitrary attributes (potential for abuse, breakage?)</p></li>
<li><p>An admin is a special kind of delegation, need a way to recognize
this in the UI</p></li>
</ul>
</section>
<section id="new-aci-parser">
<h2>New ACI Parser<a class="headerlink" href="#new-aci-parser" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>a fuller ACI class that can handle more complex syntax</p>
<ul>
<li><p>Needs to understand LDAP target</p></li>
<li><p>Ability to set source to targetattr, targetfilter and/or target</p></li>
<li><p>Set rights as a list</p></li>
<li><p>Validate ACIs before they are written</p></li>
</ul>
</li>
</ul>
</section>
<section id="ui-requirements">
<h2>UI Requirements<a class="headerlink" href="#ui-requirements" title="Permalink to this heading">¶</a></h2>
<p>It is difficult to select an individual ACI over LDAP. What we will do
instead is slurp in all of them and prove that to the UI to display.
This should be refreshed between operations to avoid concurrency issues.</p>
<p>Once an ACI is written to LDAP it is immediately in effect.</p>
<p>The following operations are needed:</p>
<ul class="simple">
<li><p>CRUD for managing Task groups</p></li>
<li><p>CRUD for managing ACIs</p></li>
<li><p>CRUD for managing Role groups</p></li>
</ul>
<section id="aci">
<h3>ACI<a class="headerlink" href="#aci" title="Permalink to this heading">¶</a></h3>
<p>An ACI has 4 attributes:</p>
<ul class="simple">
<li><p>name - a description of the ACI</p></li>
<li><p>source/bind rule - who is being authorized. This will generally be a
task group*</p></li>
<li><p>rights - read, write, add, delete, search, and selfwrite (may be more
than one)</p></li>
<li><p>target - May specify whether = or != one or more of the following:</p>
<ul>
<li><p>target - an LDAP uri pointing at a specific entry or a subtree</p></li>
<li><p>targetattr - one or more attributes</p></li>
<li><p>targetfilter - an LDAP filter</p></li>
</ul>
</li>
</ul>
<p>There are a couple of special LDAP bind rules:</p>
<ul class="simple">
<li><p>userdn = “<a class="reference external" href="ldap:///self">ldap:///self</a>”</p></li>
<li><p>userdn = “<a class="reference external" href="ldap:///anyone">ldap:///anyone</a>”</p></li>
</ul>
<p>self is used when defining an ACI for self-service. These are things
that you can do in your own record.</p>
<p>anyone is any bind, including an anonymous one.</p>
</section>
<section id="task-groups">
<h3>Task Groups<a class="headerlink" href="#task-groups" title="Permalink to this heading">¶</a></h3>
<p>A task group has 3 attributes:</p>
<ul class="simple">
<li><p>cn (the group name)</p></li>
<li><p>description</p></li>
<li><p>member</p></li>
</ul>
<p>A member is a role group(s)</p>
<p>The membership of task groups will be read only. This will be managed
from the Role Groups. Otherwise may seem a bit backwards. What we are
doing with Role groups is defining what tasks a role may execute. To do
that we add the Role to the task group.</p>
<section id="how-to-create-a-new-task">
<h4>How to create a new Task<a class="headerlink" href="#how-to-create-a-new-task" title="Permalink to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p>Create a new task group for the task</p></li>
<li><p>Create an ACI and assign it to the task group you just created</p></li>
</ol>
</section>
</section>
<section id="id1">
<h3>Role Groups<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>A role group has 3 attributes:</p>
<ul class="simple">
<li><p>cn (the group name)</p></li>
<li><p>description</p></li>
<li><p>member</p></li>
</ul>
<p>A member can either be another role group, a group or a user.</p>
<p>The Add/Update operations need to provide the ability to manage
membership of the task group. This defines the users/groups/roles that
may do the tasks associated with the role.</p>
<p>It also needs to provide the ability to manage which tasks a role may
operate on. By adding a task to a role the role gets added as a group
member of the task.</p>
</section>
</section>
</section>
<section id="additional-possible-capabilities">
<h1>Additional Possible Capabilities<a class="headerlink" href="#additional-possible-capabilities" title="Permalink to this heading">¶</a></h1>
<p>These would be for v3 or beyond.</p>
<section id="limit-bind-rules">
<h2>Limit Bind Rules<a class="headerlink" href="#limit-bind-rules" title="Permalink to this heading">¶</a></h2>
<p>We can add on additional bind rules for making changes if desired by:</p>
<ul class="simple">
<li><p>IP</p></li>
<li><p>time of day</p></li>
<li><p>IP</p></li>
<li><p>hostname</p></li>
</ul>
</section>
</section>
<section id="current-state-of-affairs">
<h1>Current State of Affairs<a class="headerlink" href="#current-state-of-affairs" title="Permalink to this heading">¶</a></h1>
<p>Currently all ACIs are put into cn=accounts,dc=example,dc=com and can
grant the ability to write a fixed set of attributes from one group of
users to another.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">aci: (targetattr=&quot;title&quot;)(targetfilter=&quot;(memberOf=cn=bar,cn=groups,cn=accounts</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">,dc=example,dc=com)&quot;)(version 3.0;acl &quot;foobar&quot;;allow (write) groupdn=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`ldap://</span></code> &lt;<a class="reference external" href="ldap://">ldap://</a>&gt;`__</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">/cn=foo,cn=groups,cn=accounts,dc=example,dc=com&quot;;)</span></code></div>
</div>
</section>
<section id="who-writes-the-acis-tasks-and-roles">
<h1>Who writes the ACIs, tasks and roles?<a class="headerlink" href="#who-writes-the-acis-tasks-and-roles" title="Permalink to this heading">¶</a></h1>
<p>Plugin authors, who know best what access may be granted for their given
operations, will create a list of ACIs for the plugin. This will likely
revolve around the CRUD operations to grant create, read, update and
delete access. There are special cases too, such as granting write
access to specific attributes in the case of passwords.</p>
<p>A predefined set of Roles will be created as well. The initial list will
be:</p>
<ul class="simple">
<li><p>Helpdesk</p></li>
<li><p>User admin</p></li>
<li><p>Group admin</p></li>
<li><p>Replica admin</p></li>
<li><p>Host admin</p></li>
<li><p>Service admin</p></li>
<li><p>CA admin</p></li>
<li><p>Netgroup admin</p></li>
<li><p>automount admin</p></li>
<li><p>netgroups admin</p></li>
</ul>
</section>
<section id="how-will-acis-be-created">
<h1>How will ACIs be created?<a class="headerlink" href="#how-will-acis-be-created" title="Permalink to this heading">¶</a></h1>
<p>There will be no web UI for creating new ACIs.</p>
</section>
<section id="how-will-acis-be-modified">
<h1>How will ACIs be modified?<a class="headerlink" href="#how-will-acis-be-modified" title="Permalink to this heading">¶</a></h1>
<p>The only modifications to ACIs will be in the list of attributes that
they cover and will only be available from the CLI.</p>
<p>For example, the edit User ACI may need to be expanded to include more
attributes than we grant by default. This CLI capability will let an
admin select from a set of attributes those whihc may be written.</p>
</section>
<section id="diagram">
<h1>Diagram<a class="headerlink" href="#diagram" title="Permalink to this heading">¶</a></h1>
<p>A picture for your viewing pleasure.</p>
<p>Remember:</p>
<ul class="simple">
<li><p>An ACI grants access to an operation to a single Task group</p></li>
<li><p>A Role is a member of one or more Task groups</p></li>
<li><p>A user, group or Role is a member of one or more Roles</p></li>
</ul>
<figure class="align-default" id="id2">
<img alt="Picture" src="../../_images/Delegation.png" />
<figcaption>
<p><span class="caption-text">Picture</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/Access_Control.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>