<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Introduction" href="NewCA.html" />
    <link rel="prev" title="Configure the DNS client" href="NetApp_integration_in_a_mixed_environment.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>The purpose of this page is to outline a plan for binding an encrypted
disk to a network.</p>
<section id="use-case">
<span id="id1"></span><h2>Use Case<a class="headerlink" href="#use-case" title="Permalink to this heading">¶</a></h2>
<p>A server’s storage contains sensitive data. Suddenly, the disk fails.
The disk needs to be sent in for warranty service. However, corporate
policy does not permit the disclosure of this data. Since the drive has
failed, it cannot be wiped.</p>
<p>While simply encrypting this disk with a master secret will suffice, the
management for this is cumbersome. Either manual intervention is
required for encryption and booting or the master secret needs to be
shared in automation tooling risking the security of the system.</p>
<p>What is required is an automated system for provisioning and acquisition
of per-host decryption keys.</p>
</section>
</section>
<section id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this heading">¶</a></h1>
<p>The basic workflow is two steps:</p>
<ol class="arabic simple">
<li><p>Provisioning: enabling the encrypted host for automatic decryption</p></li>
<li><p>Acquisition: fetching the decryption key and using it to unlock the
disk</p></li>
</ol>
<p>This process is implemented using
<a class="reference external" href="https://github.com/npmccallum/petera">Petera</a>. For an example of
this workflow, see the <a class="reference external" href="https://github.com/npmccallum/petera/wiki">Petera Disk Encryption
instructions</a>.</p>
<section id="provisioning">
<h2>Provisioning<a class="headerlink" href="#provisioning" title="Permalink to this heading">¶</a></h2>
<p>Provisioning is the process whereby the encrypted host is enabled for
automatic decryption at boot. This process presumes that the disk is
already encrypted at install time using a recovery key. Alternatively,
the provisioning process can be cooked into Anaconda directly.</p>
<ol class="arabic simple">
<li><p>Generate a random key</p></li>
<li><p>Add the random key to LUKS</p></li>
<li><p>Encrypt the random key to the Petera server’s encryption certificate
(online or offline operation)</p></li>
<li><p>Store the encrypted random key on the local (encrypted) disk</p></li>
<li><p>Copy the encrypted random key into the initramfs</p></li>
</ol>
<p>No data is ever stored on the Petera server. This entire procedure can
be performed offline if the Petera server’s encryption certificate is
known.</p>
</section>
<section id="acquisition">
<h2>Acquisition<a class="headerlink" href="#acquisition" title="Permalink to this heading">¶</a></h2>
<p>These are the steps that occur in the initramfs in order to decrypt the
root volume.</p>
<ol class="arabic simple">
<li><p>Bring up the network</p></li>
<li><p>Connect to the Petera server and validate the TLS certificate
(including stapled OCSP)</p></li>
<li><p>Send the encrypted random key to the Petera server</p></li>
<li><p>Receive the (decrypted) random key from the Petera server</p></li>
<li><p>Use the random key to decrypt the disk</p></li>
</ol>
<p>This process is entirely automated and the random key can only ever be
decrypted by the Petera server. This requires network connectivity, but
no authentication is needed.</p>
</section>
</section>
<section id="other-considerations">
<span id="id2"></span><h1>Other Considerations<a class="headerlink" href="#other-considerations" title="Permalink to this heading">¶</a></h1>
<section id="escrow">
<h2>Escrow<a class="headerlink" href="#escrow" title="Permalink to this heading">¶</a></h2>
<p>Recovery key escrow is not part of this plan. It is likely that we will
also want to generate a random recovery key and store it somewhere
secure. This should probably be the FreeIPA Vault.</p>
<p>The escrow feature only requires changes to provisioning and/or
Anaconda. The acquisition phase should not be affected.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/Network_Bound_Disk_Encryption.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>