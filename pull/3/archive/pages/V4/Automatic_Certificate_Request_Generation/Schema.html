<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Background" href="Thinking_About_Templating_Post.html" />
    <link rel="prev" title="Overview" href="Mapping_Rules.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>This page is an <strong>obsolete previous version</strong> of the storage components
of the <a class="reference external" href="V4/Automatic_Certificate_Request_Generation">Automatic Certificate Request
Generation</a> design. We
begin with an informal overview of the design, followed by an effort to
flatten the informal schema description into a valid LDAP schema.</p>
<p>Note: OIDs are taken from the space immediately after the other
certificate profiles schema in
<code class="docutils literal notranslate"><span class="pre">install/share/60certificate-profiles.ldif</span></code>.</p>
<section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>Cert mapping rule objects:</p>
<ul class="simple">
<li><p>Name</p></li>
<li><p>Description</p></li>
<li><p>Transformation rule (multi-value):</p>
<ul>
<li><p>Target CSR generator (e.g. openssl)</p></li>
<li><p>Transformation template (see
<a class="reference external" href="V4/Automatic_Certificate_Request_Generation/Mapping_Rules">V4/Automatic_Certificate_Request_Generation/Mapping_Rules</a>)</p></li>
</ul>
</li>
</ul>
<p>Additions to cert profile objects:</p>
<ul class="simple">
<li><p>Cert mapping rule (multi-value):</p>
<ul>
<li><p>DN of cert mapping rule for syntax and name of field</p></li>
<li><p>DN of cert mapping rule for field value (multi-value)</p></li>
</ul>
</li>
</ul>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>A profile for an S/MIME user cert should have the following cert mapping
rules:</p>
<ul class="simple">
<li><p>Cert mapping rule</p>
<ul>
<li><p>NameRule: “subjectName”</p></li>
<li><p>ValueRule: “defaultOrganizationDN”</p></li>
</ul>
</li>
<li><p>Cert mapping rule</p>
<ul>
<li><p>NameRule: “subjectAltName”</p></li>
<li><p>ValueRule: “qualifiedEmailAddress”</p></li>
<li><p>ValueRule: “qualifiedDirName”</p></li>
</ul>
</li>
</ul>
<p>Then, the definitions of these cert mapping rules (transformations
currently given using <a class="reference external" href="https://git.fedorahosted.org/cgit/slapi-nis.git/plain/doc/format-specifiers.txt">NIS function specifier
syntax</a>
but see
<a class="reference external" href="V4/Automatic_Certificate_Request_Generation/Mapping_Rules">V4/Automatic_Certificate_Request_Generation/Mapping_Rules</a>
for discussion of alternatives):</p>
<ul class="simple">
<li><ul>
<li><p>Name: subjectName</p></li>
<li><p>Description: Subject Name field of certificate.</p></li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: openssl</p></li>
<li><p>Template: “distinguished_name=%{values}”</p></li>
</ul>
</li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: certutil</p></li>
<li><p>Template: “-s %{values}”</p></li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><p>Name: defaultOrganizationDN</p></li>
<li><p>Description: Principal name as CN, with default O field appended.</p></li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: openssl</p></li>
<li><p>Template: “CN=%{cn},O=EXAMPLE.COM”</p></li>
</ul>
</li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: certutil</p></li>
<li><p>Template: “CN=%{cn},O=EXAMPLE.COM”</p></li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><p>Name: subjectAltName</p></li>
<li><p>Description: Subject Alternate Name extension.</p></li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: openssl</p></li>
<li><p>Template: “subjectAltName=%merge(‘,’, %{values})”</p></li>
</ul>
</li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: certutil</p></li>
<li><p>Template: “–extSAN=%merge(‘,’, %{values})”</p></li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><p>Name: qualifiedEmailAddress</p></li>
<li><p>Description: Principal’s email address, with tag to mark it as an
email.</p></li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: openssl</p></li>
<li><p>Template: “email:%{email}”</p></li>
</ul>
</li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: certutil</p></li>
<li><p>Template: “rfc822:%{email}”</p></li>
</ul>
</li>
</ul>
</li>
<li><ul>
<li><p>Name: qualifiedDirName</p></li>
<li><p>Description: Principal’s DN, with tag to mark it as a dirName.</p></li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: openssl</p></li>
<li><p>Template: “dirName:%opensslSection(%{dn})”</p></li>
</ul>
</li>
<li><p>Transformation rule</p>
<ul>
<li><p>Helper: certutil</p></li>
<li><p>Template: “dn:%merge(‘,’, %{dn})”</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Note: <code class="docutils literal notranslate"><span class="pre">%opensslSection</span></code> is a hypothetical openssl-specific directive
that would create a new config file section for the components of
<code class="docutils literal notranslate"><span class="pre">%{dn}</span></code> and place a reference to that section in the template output.</p>
</section>
</section>
<section id="certificate-profiles">
<span id="id1"></span><h1>Certificate Profiles<a class="headerlink" href="#certificate-profiles" title="Permalink to this heading">¶</a></h1>
<p>The objects in this section will be considered conceptually part of the
certificate profile, and represent the way that specific profile is
configured to build a certificate request. These objects will be
imported and exported along with the certificate profile.</p>
<section id="certprofile-additions">
<span id="id2"></span><h2>CertProfile additions<a class="headerlink" href="#certprofile-additions" title="Permalink to this heading">¶</a></h2>
<p>In each CertProfile, we can now list the fields that need to be mapped
into the certificate request.</p>
<ul class="simple">
<li><p>Cert field mapping (multi-value): reference to CertFieldMappingRule</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>attributeTypes: (2.16.840.1.113730.3.8.21.1.9 NAME &#39;ipaCertFieldMapping&#39; DESC &#39;Reference to ipaCertFieldMappingRule: Ruleset describing how to construct a certificate field&#39; SUP distinguishedName EQUALITY distinguishedNameMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 X-ORIGIN &#39;IPA v4.5&#39; )
objectClasses: (2.16.840.1.113730.3.8.21.2.1 NAME &#39;ipaCertProfile&#39; SUP top STRUCTURAL MUST ( cn $ description $ ipaCertProfileStoreIssued ) MAY ipaCertFieldMapping X-ORIGIN &#39;IPA v4.2&#39; )
</pre></div>
</div>
</section>
<section id="certfieldmappingrule">
<h2>CertFieldMappingRule<a class="headerlink" href="#certfieldmappingrule" title="Permalink to this heading">¶</a></h2>
<p>This object represents the way a particular field should be constructed
in CSRs for this certificate profile.</p>
<ul class="simple">
<li><p>Name</p></li>
<li><p>Cert syntax mapping: DN of CertMappingRuleset for syntax and name of
field</p></li>
<li><p>Cert data mapping (multi-value): DN of CertMappingRuleset for field
value</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>attributeTypes: (2.16.840.1.113730.3.8.21.1.10 NAME &#39;ipaCertSyntaxMapping&#39; DESC &#39;Reference to ipaCertMappingRuleset: How to format the specification for this field&#39; SUP distinguishedName EQUALITY distinguishedNameMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 SINGLE-VALUE X-ORIGIN &#39;IPA v4.5&#39; )
attributeTypes: (2.16.840.1.113730.3.8.21.1.11 NAME &#39;ipaCertDataMapping&#39; DESC &#39;Reference to ipaCertMappingRuleset: How to map data into field values&#39; SUP distinguishedName EQUALITY distinguishedNameMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 X-ORIGIN &#39;IPA v4.5&#39; )
objectClasses: (2.16.840.1.113730.3.8.21.2.4 NAME &#39;ipaCertFieldMappingRule&#39; SUP top STRUCTURAL MUST ( cn $ ipaCertSyntaxMapping $ ipaCertDataMapping ) X-ORIGIN &#39;IPA v4.5&#39; )
</pre></div>
</div>
</section>
</section>
<section id="mapping-rules">
<span id="id3"></span><h1>Mapping Rules<a class="headerlink" href="#mapping-rules" title="Permalink to this heading">¶</a></h1>
<p>The objects in this section conceptually make up the “mapping rules.”
They are built into FreeIPA (or, once the ability to do so is added,
created by an administrator).</p>
<p>Each rule for transforming data to config syntax must be associated with
the specific helper that can consume that syntax. There are two possible
approaches to representing this association. Option B, which uses
attribute tagging to record the helper, has one fewer objectClass and
stores the data in fewer objects. However, it limits future
extensibility because the rule is stored in text string rather than
having its own entry. This means that if additional metadata is required
(as a possible example, one might want to record whether a string
represents a command-line option or a config file line) it will need to
be encoded in the text of the rule. It is difficult to determine whether
this is a serious problem.</p>
<section id="option-a">
<span id="id4"></span><h2>Option A<a class="headerlink" href="#option-a" title="Permalink to this heading">¶</a></h2>
<p>In this option, the association to helpers is accomplished by placing
each rule in a separate CertTransformationRule object that records both
the rule and the helper that it belongs to. A CertMappingRuleset
references several of these CertTransformationRules, as seen in the
following diagram: <img alt="CertMappingSchemaA.dot.png" src="../../../../_images/CertMappingSchemaA.dot.png" /></p>
<section id="certmappingruleset">
<h3>CertMappingRuleset<a class="headerlink" href="#certmappingruleset" title="Permalink to this heading">¶</a></h3>
<p>This object represents the ways a data item might need to be formatted
to achieve a particular CSR result, for all the different CSR generation
helpers.</p>
<ul class="simple">
<li><p>Name</p></li>
<li><p>Description</p></li>
<li><p>Transformation rule (multi-value): reference to
CertTransformationRule</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>attributeTypes: (2.16.840.1.113730.3.8.21.1.12 NAME &#39;ipaCertTransformation&#39; DESC &#39;Reference to ipaCertTransformationRule: How a data item should be mapped for a particular helper&#39; SUP distinguishedName EQUALITY distinguishedNameMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 X-ORIGIN &#39;IPA v4.5&#39; )
objectClasses: (2.16.840.1.113730.3.8.21.2.5 NAME &#39;ipaCertMappingRuleset&#39; SUP top STRUCTURAL MUST ( cn $ description $ ipaCertTransformation ) X-ORIGIN &#39;IPA v4.5&#39; )
</pre></div>
</div>
</section>
<section id="certtransformationrule">
<h3>CertTransformationRule<a class="headerlink" href="#certtransformationrule" title="Permalink to this heading">¶</a></h3>
<p>This object represents a particular way of transforming data, for a
particular CSR generation helper.</p>
<ul class="simple">
<li><p>Name</p></li>
<li><p>Target CSR generator (e.g. openssl)</p></li>
<li><p>Transformation template (see
<a class="reference external" href="V4/Automatic_Certificate_Request_Generation/Mapping_Rules">V4/Automatic_Certificate_Request_Generation/Mapping_Rules</a>)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>attributeTypes: (2.16.840.1.113730.3.8.21.1.13 NAME &#39;ipaCertTransformationTemplate&#39; DESC &#39;How to transform a specific data item&#39; EQUALITY caseExactMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 SINGLE-VALUE X-ORIGIN &#39;IPA v4.5&#39; )
attributeTypes: (2.16.840.1.113730.3.8.21.1.14 NAME &#39;ipaCertTransformationHelper&#39; DESC &#39;Helper to which this transformation is targeted&#39; EQUALITY caseExactMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 SINGLE-VALUE X-ORIGIN &#39;IPA v4.5&#39; )
objectClasses: (2.16.840.1.113730.3.8.21.2.6 NAME &#39;ipaCertTransformationRule&#39; SUP top STRUCTURAL MUST ( cn $ ipaCertTransformationTemplate $ ipaCertTransformationHelper ) X-ORIGIN &#39;IPA v4.5&#39; )
</pre></div>
</div>
</section>
</section>
<section id="option-b">
<span id="id5"></span><h2>Option B<a class="headerlink" href="#option-b" title="Permalink to this heading">¶</a></h2>
<p>In this option, the association of rules to helpers is accomplished
using LDAP attribute tagging. A CertMappingRuleset has a multi-valued
attribute to store the rules, and each such attribute is tagged with the
helper to which the rule belongs. <img alt="CertMappingSchemaB.dot.png" src="../../../../_images/CertMappingSchemaB.dot.png" /></p>
<section id="certmappingruleset-1">
<span id="id6"></span><h3>CertMappingRuleset<a class="headerlink" href="#certmappingruleset-1" title="Permalink to this heading">¶</a></h3>
<p>This object represents the ways a data item might need to be formatted
to achieve a particular CSR result, for all the different CSR generation
helpers.</p>
<ul class="simple">
<li><p>Name</p></li>
<li><p>Description</p></li>
<li><p>Transformation rule (multi-value): Rule for transforming data into
helper syntax. Must provide the helper name as attribute tag.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>attributeTypes: (2.16.840.1.113730.3.8.21.1.12 NAME &#39;ipaCertTransformation&#39; DESC &#39;How to transform a specific item for a specific helper&#39; EQUALITY caseExactMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 X-ORIGIN &#39;IPA v4.5&#39; )
objectClasses: (2.16.840.1.113730.3.8.21.2.5 NAME &#39;ipaCertMappingRuleset&#39; SUP top STRUCTURAL MUST ( cn $ description $ ipaCertTransformation ) X-ORIGIN &#39;IPA v4.5&#39; )
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../../_sources/archive/pages/V4/Automatic_Certificate_Request_Generation/Schema.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>