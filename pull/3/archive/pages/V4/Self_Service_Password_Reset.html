<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Self Service Password Reset &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Overview" href="Server_Roles.html" />
    <link rel="prev" title="Overview" href="Replicated_lockout.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="self-service-password-reset">
<span id="id1"></span><h1>Self Service Password Reset<a class="headerlink" href="#self-service-password-reset" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>One of the most highly requested features of FreeIPA is self-service
password reset. While there is no truly secure way to implement
self-service password reset, for many users, a sufficiently secure
scheme can be devised. This proposal outlines an extension to the
self-service web portal that allows for self-service password reset,
without hard-coding into the complicated and delicate code that handles
password authentication in the core FreeIPA project.</p>
</section>
<section id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this heading">¶</a></h2>
<section id="community-sites">
<span id="id2"></span><h3>Community Sites<a class="headerlink" href="#community-sites" title="Permalink to this heading">¶</a></h3>
<p>Community Sites wishing to use FreeIPA might have user bases too large
or geographically diverse to make administrator-initiated resets
impractical. Other community sites using FreeIPA in a non-critical role
might accept the trade-off of security for convenience.</p>
</section>
</section>
<section id="design">
<h2>Design<a class="headerlink" href="#design" title="Permalink to this heading">¶</a></h2>
<section id="high-level-architecture-and-workflow">
<span id="id3"></span><h3>High-Level Architecture and Workflow<a class="headerlink" href="#high-level-architecture-and-workflow" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>A user has forgotten their password and navigates to the forgot
password page.</p></li>
<li><p>The user inputs their uid to a form on the self-service portal</p></li>
<li><p>The self-service portal queries the FreeIPA server once to determine
that the uid is valid and what the email address of the uid provided
is. The user is redirected to a notice that a password reset has been
initiated, but not given any confirmation as to whether or not the
username is valid and the request can be completed.</p></li>
<li><p>The self-service portal generates a nonce (the password reset token),
which is emailed to the user’s email address. The token is also
logged in a database, along with the uid of the requesting user and a
time and date that the request is initiated and when it expires.</p></li>
<li><p>The user receive the token in the email. If the user did not request
the reset, they can simply ignore the token and the reset request
will expire. If the user did wish to reset their password, the user
inputs the token into the self-service portal. If the token has not
expired, the user asked for confirmation that they wish to reset
their password.</p></li>
<li><p>When confirmed, the portal generates a second nonce. The portal calls
to the FreeIPA server and sets the user’s password to this second
nonce. The user is displayed a new, temporary password which they use
immediately.</p></li>
<li><p>The user logs into the FreeIPA WebUI with the new password and is
immediately prompted to change the password to a permanent value. The
user can now access the account regularly.</p></li>
</ol>
</section>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">¶</a></h2>
<p>The permissions for the self-service portal machine user account will
have to be expanded to allow the self-service portal to reset user
accounts. This is obviously risky, but the risk can be mitigated by
fine-tuning permissions so that the self-service user cannot reset the
password of administrator users. If the self-service account is found to
be compromised, then it can simply be disabled while the security hole
is repaired.</p>
<p>However, on the positive side, this external method of reseting user
passwords allows us to implement what is essentially an unsecure feature
without compromising on the security of the FreeIPA core for users who
opt not to enable self-service password reset.</p>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this heading">¶</a></h3>
<p>The self-service password reset will be built on the existing
self-service portal, and so adds few new dependencies.</p>
<p>The one very important dependency is the choice of persistant data
store, so that reset tokens can be preserved. The simplest choice would
be to use a SQLite database to store the token information. However, a
key-value database like Redis might also be suitable. Data integrity in
the database is not important, because if a token accidentally becomes
unavailable, then the user can simply generate another with no
consequence. Tokens can be periodically expunged from the database
through the use of a sweeper script, or the tokens can be allowed to
persist in the database forever as a log of request attempts.</p>
</section>
</section>
<section id="how-to-test">
<span id="how-to-test34"></span><h2>How to Test<a class="headerlink" href="#how-to-test" title="Permalink to this heading">¶</a></h2>
<p>Like the self-service portal, self-service password reset can be tested
very simply with automated unit and integration tests, and no bulk
testing configuration should be needed.</p>
<p><a class="reference external" href="Category:FreeIPA_Community_Portal">Category:FreeIPA Community
Portal</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/archive/pages/V4/Self_Service_Password_Reset.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>