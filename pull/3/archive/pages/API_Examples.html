<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; FreeIPA  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="ARM.html" />
    <link rel="prev" title="IPA XML-RPC API" href="API.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>Some useful links:</p>
<ul class="simple">
<li><p>Net::IPA</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Perl 5 interface of the FreeIPA JSON-RPC API</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">This library is going to be deprecaded and replaced by Net::FreeIPA.</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">`https://github.com/NickCis/perl-Net-IPA</span></code> &lt;<a class="reference external" href="https://github.com/NickCis/perl-Net-IPA">https://github.com/NickCis/perl-Net-IPA</a>&gt;`__</div>
</div>
<ul class="simple">
<li><p>p5-net-freeipa</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Perl5 NET::FreeIPA (FreeIPA 4.2+ JSON API)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">`https://github.com/stdweird/p5-net-freeipa</span></code> &lt;<a class="reference external" href="https://github.com/stdweird/p5-net-freeipa">https://github.com/stdweird/p5-net-freeipa</a>&gt;`__</div>
</div>
<ul class="simple">
<li><p>Blog of ALEXANDER BOKOVOY</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">`https://vda.li/en/posts/2016/11/02/FreeIPA-JSON-RPC-API-article/</span></code> &lt;<a class="reference external" href="https://vda.li/en/posts/2016/11/02/FreeIPA-JSON-RPC-API-article/">https://vda.li/en/posts/2016/11/02/FreeIPA-JSON-RPC-API-article/</a>&gt;`__</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">`https://vda.li/en/docs/freeipa-management-in-a-nutshell/</span></code> &lt;<a class="reference external" href="https://vda.li/en/docs/freeipa-management-in-a-nutshell/">https://vda.li/en/docs/freeipa-management-in-a-nutshell/</a>&gt;`__</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">`https://vda.li/en/posts/2015/05/28/talking-to-freeipa-api-with-sessions/</span></code> &lt;<a class="reference external" href="https://vda.li/en/posts/2015/05/28/talking-to-freeipa-api-with-sessions/">https://vda.li/en/posts/2015/05/28/talking-to-freeipa-api-with-sessions/</a>&gt;`__</div>
</div>
<ul class="simple">
<li><p>Red Hat article on the API</p></li>
</ul>
<p>`` <code class="docutils literal notranslate"><span class="pre">\</span> <span class="pre">```https://access.redhat.com/articles/2728021</span></code> &lt;<a class="reference external" href="https://access.redhat.com/articles/2728021">https://access.redhat.com/articles/2728021</a>&gt;`__</p>
<ul class="simple">
<li><p>attachment to this post shows how simple user/password auth works:</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">`https://www.redhat.com/archives/freeipa-users/2015-November/msg00132.html</span></code> &lt;<a class="reference external" href="https://www.redhat.com/archives/freeipa-users/2015-November/msg00132.html">https://www.redhat.com/archives/freeipa-users/2015-November/msg00132.html</a>&gt;`__</p>
<ul class="simple">
<li><p>python-freeipa-json</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Tiny/basic module for communicating with the FreeIPA API without having to install their entire toolchain</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">`https://github.com/nordnet/python-freeipa-json</span></code> &lt;<a class="reference external" href="https://github.com/nordnet/python-freeipa-json">https://github.com/nordnet/python-freeipa-json</a>&gt;`__</div>
</div>
<p>Example API perl script</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">#!/usr/bin/perl</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">#</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># Created by GG -- 20180306</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># Version 1.0</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># GPLv3</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># this script adds a new entry to IPA DNS and creates a host object with otp for registration</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># for our automatic deployments, after this the machine gets created in vmware, kickstarted and provisioned</span></code></div>
<div class="line">`` ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">use strict;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">use REST::Client;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">use JSON;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">use ``\</span> <span class="pre">```Data::Dumper</span></code> &lt;<a class="reference external" href="Data::Dumper">Data::Dumper</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">;</span></code></div>
<div class="line">`` ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># IPA server data</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $ipaserver=&quot;</span></code><code class="docutils literal notranslate"><span class="pre">`https://ipa.yourdomain.com</span></code> &lt;<a class="reference external" href="https://ipa.yourdomain.com">https://ipa.yourdomain.com</a>&gt;`__<code class="docutils literal notranslate"><span class="pre">&quot;;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $ipausername=&quot;ipauser&quot;;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $ipapassword=&quot;ipapassword&quot;;</span></code></div>
<div class="line">`` ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">## parameters for the entries to create</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $newhostname=&quot;newhost-01&quot;;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $newdomain=&quot;yourdomain.com&quot;;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $newip=&quot;192.168.1.1&quot;;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre"># We use a one time password in our scripts to register machines on firstboot</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">my $newotp=&quot;OneTimePassword&quot;;</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">## end parameters</span></code></div>
<div class="line">`` ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">create_ipa_entries($newhostname, $newdomain, $newip, $newotp, $ipaserver, $ipausername, $ipapassword);</span></code></div>
<div class="line">`` ``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">sub create_ipa_entries {</span></code></div>
<div class="line">`` ``</div>
<div class="line">``  my ($hostname,$domain,$ip,$otp,$server,$username,$password) = &#64;_;``</div>
<div class="line">`` ``</div>
<div class="line">``  # this is the apiversion of the IPA server``</div>
<div class="line">``  # this should only be changed if we are sure future versions support this syntax``</div>
<div class="line">``  my $apiversion=”2.213”;``</div>
<div class="line">`` ``</div>
<div class="line">``  my $fqdn=$hostname . “.” . $domain;``</div>
<div class="line">``  my $uri = URI-&gt;new($server);``</div>
<div class="line">`` ``</div>
<div class="line">``  my $authheader= {``</div>
<div class="line">``  ‘Accept’ =&gt; ‘text/plain’,``</div>
<div class="line">``  ‘referer’ =&gt; $server . “/ipa”,``</div>
<div class="line">``  ‘Content-Type’ =&gt; ‘application/x-www-form-urlencoded’,``</div>
<div class="line">``  };``</div>
<div class="line">`` ``</div>
<div class="line">``  my $jsonheader= {``</div>
<div class="line">``  ‘Accept’ =&gt; ‘application/json’,``</div>
<div class="line">``  ‘referer’ =&gt; $server . “/ipa”,``</div>
<div class="line">``  ‘Content-Type’ =&gt; ‘application/json’,``</div>
<div class="line">``  };``</div>
<div class="line">`` ``</div>
<div class="line">``  my $authbody = {``</div>
<div class="line">``  ‘user’ =&gt; $username,``</div>
<div class="line">``  ‘password’ =&gt; $password,``</div>
<div class="line">``  };``</div>
<div class="line">`` ``</div>
<div class="line">``  # see FreeIPA api dnsrecord_add``</div>
<div class="line">``  my $dnsadd = {``</div>
<div class="line">``      “method” =&gt; “dnsrecord_add”,``</div>
<div class="line">``      “params” =&gt; [``</div>
<div class="line">``          [``</div>
<div class="line">``              $domain,``</div>
<div class="line">``              {``</div>
<div class="line">``                  “__dns_name__” =&gt; $hostname``</div>
<div class="line">``              }``</div>
<div class="line">``          ],``</div>
<div class="line">``          {``</div>
<div class="line">``              “a_extra_create_reverse” =&gt; “true”,``</div>
<div class="line">``              “a_part_ip_address” =&gt; $ip,``</div>
<div class="line">``              “version” =&gt; $apiversion``</div>
<div class="line">``          }``</div>
<div class="line">``      ],``</div>
<div class="line">``      “id” =&gt; 0``</div>
<div class="line">``  };``</div>
<div class="line">`` ``</div>
<div class="line">``  # see FreeIPA api host_add``</div>
<div class="line">``  my $hostadd = {``</div>
<div class="line">``      “method” =&gt; “host_add”,``</div>
<div class="line">``      “params” =&gt; [``</div>
<div class="line">``          [``</div>
<div class="line">``              $fqdn``</div>
<div class="line">``          ],``</div>
<div class="line">``          {``</div>
<div class="line">``              “userpassword” =&gt; $otp,``</div>
<div class="line">``          “version” =&gt; $apiversion``</div>
<div class="line">``          }``</div>
<div class="line">``      ],``</div>
<div class="line">``      “id” =&gt; 0``</div>
<div class="line">``  };``</div>
<div class="line">`` ``</div>
<div class="line">``  # create useragent with cookie support``</div>
<div class="line">``  my $ua = LWP::UserAgent-&gt;new( cookie_jar =&gt; {} );``</div>
<div class="line">``  my $client = REST::Client-&gt;new( { useragent =&gt; $ua } );``</div>
<div class="line">`` ``</div>
<div class="line">``  # login with user / password and get a session cookie``</div>
<div class="line">``  my $params = $client-&gt;buildQuery($authbody);``</div>
<div class="line">``  $client-&gt;setHost($server);``</div>
<div class="line">``  $client-&gt;POST(“/ipa/session/login_password”, substr($params, 1), $authheader);``</div>
<div class="line">``  #print Dumper $client-&gt;responseHeader(‘Set-Cookie’);``</div>
<div class="line">``  if ($client-&gt;responseContent()) {``</div>
<div class="line">``    print “IPA authentication errorn”;``</div>
<div class="line">``    # the output underneath is html formatted but I don’t want to parse it here``</div>
<div class="line">``    # so quick and dirty raw output``</div>
<div class="line">``    print Dumper $client-&gt;responseContent();``</div>
<div class="line">``    exit 1;``</div>
<div class="line">``  }``</div>
<div class="line">``  else {``</div>
<div class="line">``    print “IPA auth okn”;``</div>
<div class="line">``  }``</div>
<div class="line">`` ``</div>
<div class="line">``  # add host to DNS``</div>
<div class="line">``  $client-&gt;POST(“/ipa/session/json”, encode_json($dnsadd), $jsonheader);``</div>
<div class="line">``  #print Dumper $client-&gt;responseContent();``</div>
<div class="line">``  my $result = decode_json($client-&gt;responseContent());``</div>
<div class="line">``  if ($result-&gt;{“error”}{“code”}) {``</div>
<div class="line">``    print “ERROR: “. $result-&gt;{“error”}{“code”} . ” ” . $result-&gt;{“error”}{“name”} . “n”;``</div>
<div class="line">``    print $result-&gt;{“error”}{“message”} . “n”;``</div>
<div class="line">``    exit 1;``</div>
<div class="line">``  }``</div>
<div class="line">``  else {``</div>
<div class="line">``    print “dns entry ” . $fqdn . ” with ip address ” . $ip . ” created in IPAn”;``</div>
<div class="line">``  }``</div>
<div class="line">`` ``</div>
<div class="line">``  # create host object in IPA and set otp``</div>
<div class="line">``  $client-&gt;POST(“/ipa/session/json”, encode_json($hostadd), $jsonheader);``</div>
<div class="line">``  #print Dumper $client-&gt;responseContent();``</div>
<div class="line">``  my $result = decode_json($client-&gt;responseContent());``</div>
<div class="line">``  if ($result-&gt;{“error”}{“code”}) {``</div>
<div class="line">``    print “ERROR: “. $result-&gt;{“error”}{“code”} . ” ” . $result-&gt;{“error”}{“name”} . “n”;``</div>
<div class="line">``    print $result-&gt;{“error”}{“message”} . “n”;``</div>
<div class="line">``    exit 1;``</div>
<div class="line">``  }``</div>
<div class="line">``  else {``</div>
<div class="line">``    print “host object ” . $fqdn . ” with otp ” . $otp . ” created in IPAn”;``</div>
<div class="line">``  }``</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">}</span></code></div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/freeipa-logo-small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, FreeIPA Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/archive/pages/API_Examples.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>